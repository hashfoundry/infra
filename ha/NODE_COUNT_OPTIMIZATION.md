# Node Count Optimization Report

## üéØ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ**
–£–º–µ–Ω—å—à–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å 4 –¥–æ 3 –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞—Ç –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ High Availability.

## ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**

### **1. Environment Configuration**

#### **ha/.env:**
```bash
# –ë—ã–ª–æ:
NODE_COUNT=4
MIN_NODES=4

# –°—Ç–∞–ª–æ:
NODE_COUNT=3
MIN_NODES=3
```

#### **ha/.env.example:**
```bash
# –ë—ã–ª–æ:
NODE_COUNT=4
MIN_NODES=4

# –°—Ç–∞–ª–æ:
NODE_COUNT=3
MIN_NODES=3
```

### **2. PodDisruptionBudget Updates**

#### **NGINX Ingress Controller PDB:**
```yaml
# –ë—ã–ª–æ:
spec:
  minAvailable: 2

# –°—Ç–∞–ª–æ:
spec:
  minAvailable: 1
```

#### **HashFoundry React App PDB:**
```yaml
# –ë—ã–ª–æ:
spec:
  minAvailable: 2

# –°—Ç–∞–ª–æ:
spec:
  minAvailable: 1
```

## üìä **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π**

### **‚úÖ High Availability —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:**
- **3 —É–∑–ª–∞** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è HA –∫–ª–∞—Å—Ç–µ—Ä–∞
- **–ö–≤–æ—Ä—É–º** –¥–ª—è etcd –∏ control plane –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - –∫–ª–∞—Å—Ç–µ—Ä –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑ 1 —É–∑–ª–∞
- **Anti-affinity –ø—Ä–∞–≤–∏–ª–∞** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ–¥—ã –ø–æ —É–∑–ª–∞–º

### **‚úÖ PodDisruptionBudget –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:**
- **minAvailable: 1** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å 3-—É–∑–ª–æ–≤—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º** - –∏–∑–±–µ–≥–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- **Graceful updates** - –ø–æ–∑–≤–æ–ª—è–µ—Ç rolling updates –±–µ–∑ –ø—Ä–æ—Å—Ç–æ–µ–≤

## üí∞ **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç**

### **–°—Ç–æ–∏–º–æ—Å—Ç—å —É–∑–ª–æ–≤ (s-2vcpu-4gb):**
```
–ë—ã–ª–æ (4 —É–∑–ª–∞):
- 4 √ó $24/–º–µ—Å—è—Ü = $96/–º–µ—Å—è—Ü

–°—Ç–∞–ª–æ (3 —É–∑–ª–∞):
- 3 √ó $24/–º–µ—Å—è—Ü = $72/–º–µ—Å—è—Ü

–≠–∫–æ–Ω–æ–º–∏—è: $24/–º–µ—Å—è—Ü (25%)
```

### **–ì–æ–¥–æ–≤–∞—è —ç–∫–æ–Ω–æ–º–∏—è:**
```
$24/–º–µ—Å—è—Ü √ó 12 –º–µ—Å—è—Ü–µ–≤ = $288/–≥–æ–¥
```

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è**

### **‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è HA:**
- **etcd –∫–≤–æ—Ä—É–º**: 3 —É–∑–ª–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–≤–æ—Ä—É–º (2+1)
- **Control plane**: DigitalOcean —É–ø—Ä–∞–≤–ª—è–µ—Ç HA control plane
- **Worker nodes**: 3 —É–∑–ª–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
- **Fault tolerance**: –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑ 1 —É–∑–ª–∞ (33% capacity)

### **‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
```
–£–∑–µ–ª 1: ArgoCD Server, Redis HA, NGINX Ingress
–£–∑–µ–ª 2: ArgoCD Controller, Redis HA, React App
–£–∑–µ–ª 3: ArgoCD Repo Server, Redis HA, NFS Server
```

### **‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è 3-—É–∑–ª–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
- **–ú–µ–Ω—å—à–∏–π –∑–∞–ø–∞—Å —Ä–µ—Å—É—Ä—Å–æ–≤** –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
- **–ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è** –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞
- **–ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥** –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏

## üîÑ **Auto-scaling –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥–∞:**
```bash
MIN_NODES=3    # –ú–∏–Ω–∏–º—É–º –¥–ª—è HA
MAX_NODES=9    # –ú–∞–∫—Å–∏–º—É–º –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
AUTO_SCALE_ENABLED=true
```

### **–¢—Ä–∏–≥–≥–µ—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:**
- **CPU utilization > 70%** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤
- **Memory pressure** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤
- **Pending pods** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤
- **Low utilization** - —É–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤ (–¥–æ –º–∏–Ω–∏–º—É–º–∞ 3)

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. **–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ 3 —É–∑–ª–∞—Ö
2. **–û—Ç–∫–∞–∑ 1 —É–∑–ª–∞** - —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
3. **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** - –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ –¥–æ–±–∞–≤–ª—è–µ—Ç —É–∑–ª—ã
4. **Rolling updates** - PDB –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∑–ª–æ–≤
kubectl get nodes

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–¥–æ–≤
kubectl get pods -o wide --all-namespaces

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PDB
kubectl get pdb --all-namespaces

# –°–∏–º—É–ª—è—Ü–∏—è –æ—Ç–∫–∞–∑–∞ —É–∑–ª–∞
kubectl drain <node-name> --ignore-daemonsets
```

## üìã **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

### **1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —É—Ç–∏–ª–∏–∑–∞—Ü–∏—é CPU/Memory –Ω–∞ —É–∑–ª–∞—Ö
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ (>80%)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

### **2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏:**
- –£—á–∏—Ç—ã–≤–∞—Ç—å –ø–∏–∫–æ–≤—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 3 —É–∑–ª–∞—Ö
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

### **3. Backup –ø–ª–∞–Ω:**
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å MIN_NODES=4
- –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ—Å—É—Ä—Å–∞–º–∏
- Terraform –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

## üéâ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–∑–ª–æ–≤ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:**

‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è**: $24/–º–µ—Å—è—Ü ($288/–≥–æ–¥) –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ HA  
‚úÖ **High Availability**: 3 —É–∑–ª–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å  
‚úÖ **PDB –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã**: —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å 3-—É–∑–ª–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π  
‚úÖ **Auto-scaling**: –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏  

**–ö–ª–∞—Å—Ç–µ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–¥–æ—Å—Ç—É–ø–Ω—ã–º –ø—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç–∞—Ö!**

---

**–î–∞—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 16.07.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ Ready for deployment  
**–≠–∫–æ–Ω–æ–º–∏—è**: 25% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É–∑–ª–æ–≤

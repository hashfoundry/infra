# 199. –ß—Ç–æ —Ç–∞–∫–æ–µ Pod Preemption –∏ –∫–∞–∫ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å?

## üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ Pod Preemption?**

**Pod Preemption** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤ Kubernetes, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º Pod'–∞–º –≤—ã—Ç–µ—Å–Ω—è—Ç—å (preempt) –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ Pod'—ã –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ —É–∑–ª–∞—Ö. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫.

## üèóÔ∏è **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Pod Preemption:**

### **1. Priority-based Scheduling**
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Pod'–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞

### **2. Graceful Termination**
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—ã—Ç–µ—Å–Ω—è–µ–º—ã—Ö Pod'–æ–≤
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ terminationGracePeriodSeconds
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è disruption –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

### **3. Resource Optimization**
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PodDisruptionBudgets
- –£—á–µ—Ç node affinity –∏ anti-affinity

## üìä **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ HA –∫–ª–∞—Å—Ç–µ—Ä–∞:**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Priority Classes:**
```bash
# –°–∏—Å—Ç–µ–º–Ω—ã–µ priority classes
kubectl get priorityclasses

# Priority classes –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
kubectl get priorityclasses -o custom-columns=NAME:.metadata.name,VALUE:.value,PREEMPTION:.preemptionPolicy

# Pod'—ã —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –≤ ArgoCD
kubectl get pods -n argocd -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority,PRIORITY_CLASS:.spec.priorityClassName

# Pod'—ã —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –≤ monitoring
kubectl get pods -n monitoring -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority,PRIORITY_CLASS:.spec.priorityClassName

# –°–æ–±—ã—Ç–∏—è preemption –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
kubectl get events --all-namespaces --field-selector reason=Preempted
```

### **2. ArgoCD —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º:**
```bash
# ArgoCD Server Pod'—ã
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server -o wide

# –ü—Ä–æ–≤–µ—Ä–∫–∞ priority class ArgoCD
kubectl describe pod -n argocd -l app.kubernetes.io/name=argocd-server | grep -A 5 "Priority"

# –†–µ—Å—É—Ä—Å—ã ArgoCD Server
kubectl describe pod -n argocd -l app.kubernetes.io/name=argocd-server | grep -A 10 "Requests"
```

### **3. Monitoring —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º:**
```bash
# Prometheus Pod'—ã
kubectl get pods -n monitoring -l app=prometheus

# Grafana Pod'—ã
kubectl get pods -n monitoring -l app.kubernetes.io/name=grafana

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ monitoring
kubectl top pods -n monitoring
kubectl describe nodes | grep -A 10 "Allocated resources"
```

### **4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ preemption:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ namespace –¥–ª—è —Ç–µ—Å—Ç–æ–≤
kubectl create namespace preemption-test

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö Pod'–æ–≤
kubectl run low-priority-1 --image=nginx --namespace=preemption-test \
  --overrides='{"spec":{"priorityClassName":"low-priority","containers":[{"name":"nginx","image":"nginx","resources":{"requests":{"cpu":"500m","memory":"512Mi"}}}]}}'

# –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ Pod'–∞
kubectl run high-priority-1 --image=nginx --namespace=preemption-test \
  --overrides='{"spec":{"priorityClassName":"high-priority","containers":[{"name":"nginx","image":"nginx","resources":{"requests":{"cpu":"2000m","memory":"2Gi"}}}]}}'

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π preemption
kubectl get events -n preemption-test --watch

# –û—á–∏—Å—Ç–∫–∞
kubectl delete namespace preemption-test
```

## üîÑ **–°–æ–∑–¥–∞–Ω–∏–µ Priority Classes:**

### **1. –°–∏—Å—Ç–µ–º–Ω—ã–µ Priority Classes:**
```bash
# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
cat << EOF | kubectl apply -f -
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: system-critical
value: 2000000000
globalDefault: false
preemptionPolicy: PreemptLowerPriority
description: "Critical system components"
EOF

# –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –≤–∞–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
cat << EOF | kubectl apply -f -
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: high-priority
value: 1000
globalDefault: false
preemptionPolicy: PreemptLowerPriority
description: "High priority services"
EOF

# –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è batch jobs
cat << EOF | kubectl apply -f -
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: low-priority
value: 100
globalDefault: true
preemptionPolicy: Never
description: "Low priority batch workloads"
EOF
```

### **2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Priority Classes:**
```bash
# ArgoCD —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl patch deployment argocd-server -n argocd -p '{"spec":{"template":{"spec":{"priorityClassName":"high-priority"}}}}'

# Prometheus —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl patch deployment prometheus-server -n monitoring -p '{"spec":{"template":{"spec":{"priorityClassName":"system-critical"}}}}'

# Grafana —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl patch deployment grafana -n monitoring -p '{"spec":{"template":{"spec":{"priorityClassName":"high-priority"}}}}'
```

## üîß **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è Pod Preemption:**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏—Ö Pod'–æ–≤:**
```bash
# Deployment —Å –Ω–∏–∑–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: resource-hog
  namespace: preemption-test
spec:
  replicas: 5
  selector:
    matchLabels:
      app: resource-hog
  template:
    metadata:
      labels:
        app: resource-hog
    spec:
      priorityClassName: low-priority
      containers:
      - name: hog
        image: busybox
        command: ["sleep", "3600"]
        resources:
          requests:
            cpu: 500m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
EOF

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è Pod'–æ–≤
kubectl get pods -n preemption-test -o wide
kubectl top nodes
```

### **2. –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ Pod'–∞:**
```bash
# Pod —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
cat << EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: critical-workload
  namespace: preemption-test
spec:
  priorityClassName: high-priority
  containers:
  - name: critical
    image: nginx:alpine
    resources:
      requests:
        cpu: 2000m
        memory: 2Gi
      limits:
        cpu: 4000m
        memory: 4Gi
EOF

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ preemption
kubectl get events -n preemption-test --field-selector reason=Preempted
kubectl get pods -n preemption-test -o custom-columns=NAME:.metadata.name,STATUS:.status.phase,PRIORITY:.spec.priority
```

### **3. Graceful Termination:**
```bash
# Pod —Å graceful shutdown
cat << EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: graceful-pod
  namespace: preemption-test
spec:
  priorityClassName: low-priority
  terminationGracePeriodSeconds: 60
  containers:
  - name: app
    image: busybox
    command: ["/bin/sh"]
    args:
    - -c
    - |
      trap 'echo "Graceful shutdown started"; sleep 30; echo "Shutdown complete"' TERM
      while true; do sleep 1; done
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
EOF

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ graceful termination
kubectl delete pod graceful-pod -n preemption-test --grace-period=60
kubectl logs graceful-pod -n preemption-test -f
```

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Pod Preemption:**

### **1. Scheduler –º–µ—Ç—Ä–∏–∫–∏:**
```bash
# Port forward –∫ Prometheus
kubectl port-forward svc/prometheus-server -n monitoring 9090:80

# Scheduler –º–µ—Ç—Ä–∏–∫–∏ –≤ Prometheus:
# scheduler_pending_pods - –æ–∂–∏–¥–∞—é—â–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Pod'—ã
# scheduler_preemption_attempts_total - –ø–æ–ø—ã—Ç–∫–∏ preemption
# scheduler_preemption_victims - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ç–µ—Å–Ω–µ–Ω–Ω—ã—Ö Pod'–æ–≤
```

### **2. –°–æ–±—ã—Ç–∏—è –∏ –ª–æ–≥–∏:**
```bash
# –°–æ–±—ã—Ç–∏—è preemption
kubectl get events --all-namespaces --field-selector reason=Preempted -o wide

# Scheduler –ª–æ–≥–∏
kubectl logs -n kube-system -l component=kube-scheduler | grep -i preempt

# Pod —Å–æ–±—ã—Ç–∏—è
kubectl describe pod <pod-name> -n <namespace> | grep -A 10 Events
```

### **3. –†–µ—Å—É—Ä—Å—ã —É–∑–ª–æ–≤:**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
kubectl top nodes
kubectl top pods --all-namespaces --sort-by=cpu

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É–∑–ª–∞—Ö
kubectl describe nodes | grep -A 15 "Allocated resources"

# Capacity –∏ allocatable
kubectl get nodes -o custom-columns=NAME:.metadata.name,CPU-CAPACITY:.status.capacity.cpu,MEMORY-CAPACITY:.status.capacity.memory,CPU-ALLOCATABLE:.status.allocatable.cpu,MEMORY-ALLOCATABLE:.status.allocatable.memory
```

## üè≠ **Pod Preemption –≤ –≤–∞—à–µ–º HA –∫–ª–∞—Å—Ç–µ—Ä–µ:**

### **1. ArgoCD High Availability:**
```bash
# ArgoCD Server —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server

# ArgoCD Application Controller
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-application-controller

# –ü—Ä–æ–≤–µ—Ä–∫–∞ priority classes
kubectl describe pod -n argocd -l app.kubernetes.io/name=argocd-server | grep Priority
```

### **2. Monitoring Stack Protection:**
```bash
# Prometheus —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl get pods -n monitoring -l app=prometheus -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority

# Grafana —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl get pods -n monitoring -l app.kubernetes.io/name=grafana -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority

# NFS Provisioner –∑–∞—â–∏—Ç–∞
kubectl get pods -n kube-system -l app=nfs-provisioner -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority
```

### **3. Application Workloads:**
```bash
# React App —Å –æ–±—ã—á–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl get pods -n hashfoundry-react -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priority

# Batch jobs —Å –Ω–∏–∑–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
kubectl get jobs --all-namespaces -o custom-columns=NAME:.metadata.name,NAMESPACE:.metadata.namespace,PRIORITY:.spec.template.spec.priority
```

## üîÑ **PodDisruptionBudget –∏ Preemption:**

### **1. PDB –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**
```bash
# ArgoCD PDB
cat << EOF | kubectl apply -f -
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: argocd-server-pdb
  namespace: argocd
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: argocd-server
EOF

# Prometheus PDB
cat << EOF | kubectl apply -f -
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: prometheus-pdb
  namespace: monitoring
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app: prometheus
EOF
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ PDB —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –í—Å–µ PDB –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
kubectl get pdb --all-namespaces

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ PDB
kubectl describe pdb argocd-server-pdb -n argocd
kubectl describe pdb prometheus-pdb -n monitoring

# PDB –∏ preemption –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
kubectl get events --all-namespaces --field-selector reason=EvictionBlocked
```

## üö® **Troubleshooting Pod Preemption:**

### **1. Pod –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ pending Pod'–æ–≤
kubectl get pods --all-namespaces --field-selector=status.phase=Pending

# –ü—Ä–∏—á–∏–Ω—ã pending
kubectl describe pod <pending-pod> -n <namespace>

# Scheduler —Å–æ–±—ã—Ç–∏—è
kubectl get events --all-namespaces --field-selector reason=FailedScheduling

# –†–µ—Å—É—Ä—Å—ã —É–∑–ª–æ–≤
kubectl describe nodes | grep -A 10 "Non-terminated Pods"
```

### **2. Preemption –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ priority classes
kubectl get priorityclasses -o custom-columns=NAME:.metadata.name,VALUE:.value,PREEMPTION:.preemptionPolicy

# Scheduler –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
kubectl get configmap kube-scheduler -n kube-system -o yaml

# Scheduler –ª–æ–≥–∏
kubectl logs -n kube-system -l component=kube-scheduler | grep -i "preemption\|priority"
```

### **3. –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ preemption:**
```bash
# –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π preemption
kubectl get events --all-namespaces --field-selector reason=Preempted --sort-by='.lastTimestamp'

# –ê–Ω–∞–ª–∏–∑ —Ä–µ—Å—É—Ä—Å–æ–≤
kubectl top pods --all-namespaces --sort-by=memory
kubectl top pods --all-namespaces --sort-by=cpu

# PDB –Ω–∞—Ä—É—à–µ–Ω–∏—è
kubectl get events --all-namespaces --field-selector reason=EvictionBlocked
```

## üéØ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Pod Preemption:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                Pod Preemption Flow                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  High Priority Pod Request                                  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Priority: 1000                                        ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Resources: 2 CPU, 4Gi Memory                          ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Cannot be scheduled on any node                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Scheduler Preemption Logic                                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Find nodes with lower priority pods                   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Calculate preemption cost                             ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Select optimal victims                                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Respect PodDisruptionBudgets                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Victim Selection                                           ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Lowest priority pods first                            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Newest pods within same priority                      ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Minimize disruption                                   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Consider node affinity                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Graceful Termination                                       ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Send SIGTERM to victim pods                           ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Wait for terminationGracePeriodSeconds                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Execute preStop hooks                                 ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Send SIGKILL if necessary                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Resource Allocation                                        ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Update node allocatable resources                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Schedule high priority pod                            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Update cluster state                                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Generate scheduling events                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîß **Best Practices –¥–ª—è Pod Preemption:**

### **1. Priority Class Design:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ—Ç–∫—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã - –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã - –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- Batch jobs - –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

### **2. Resource Management:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ resource requests –∏ limits
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ capacity –∑–∞—Ä–∞–Ω–µ–µ

### **3. Graceful Handling:**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ terminationGracePeriodSeconds
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ preStop hooks
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ graceful shutdown –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö

### **4. Monitoring –∏ Alerting:**
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å–æ–±—ã—Ç–∏—è preemption
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ preemption
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ SLA –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**Pod Preemption ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö workloads –≤ —Ä–µ—Å—É—Ä—Å–æ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö!**

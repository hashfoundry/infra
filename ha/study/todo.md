- ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ servicemonitor
- kubectl get componentstatuses - Ğ½Ğµ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½, Ğ·Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
- ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ´Ğ»Ñ managed k8s Ğ½ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ´Ğ¾ control plane
- Ğ²Ğ°Ğ¶Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ² Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğµ - ÑÑ‚Ğ¾ Ñ‚Ğ¾ Ñ‡Ñ‚Ğ¾ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ hpa Ğ½ÑƒĞ¶ĞµĞ½ metrics server
-
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑĞµÑ‚ĞµĞ²ÑƒÑ ÑĞ²ÑĞ·Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Pod'Ğ°Ğ¼Ğ¸ `kubectl exec -it <pod1> -n argocd -- ping <pod2-ip>`
- Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» Ğ²/Ğ¸Ğ· Pod'Ğ° `kubectl cp test-pod:/etc/nginx/nginx.conf ./nginx.conf`
- Multi-Container Pod (sidecar pattern):
- Init Container Pattern:
- ĞµÑÑ‚ÑŒ HPA Ğ° ĞµÑÑ‚ÑŒ VPA (VPA - ÑÑ‚Ğ¾ ĞºĞ°ĞºĞ°Ñ-Ñ‚Ğ¾ Ğ´Ğ¸Ñ‡ÑŒ)
- Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ·Ğ°Ğ¿Ñ€ĞµĞ´Ğ¸Ñ‚ÑŒ dns/Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¸Ğ· Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ½ĞµĞ¹Ğ¼ÑĞ¿ĞµĞ¹ÑĞ° Ğ¿Ğ¾Ğ´Ğ°Ğ¼ Ğ¸Ğ· Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ½ĞµĞ¹Ğ¼ÑĞ¿ĞµĞ¹ÑĞ°?

- Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğ¸ resource request/limits - Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ»Ğ¸ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ¾Ğ±Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¾
- etcd - ĞºĞ°Ğº Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿? Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°Ñ‚ÑŒÑÑ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ? ĞºĞ°Ğº Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸? ĞºĞ°Ğº Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ±ÑĞºĞ°Ğ¿Ñ‹? ĞºĞ°Ğº Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ…ÑĞ»Ñ-Ñ‡ĞµĞºĞ¸? ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸?
- kubeapi - ĞºĞ°Ğº Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿? Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°Ñ‚ÑŒÑÑ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ? ĞºĞ°Ğº Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸?
- Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ clusterIP, NodePort, LoadBalancer, ExternalName
- session affinity Ğ¸ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ğµ affinity
- `kubectl get lease kube-controller-manager -n kube-system -o yaml`
- `kubectl explain deployment`
- `kubectl get resourcequotas -A`, QoS Classes, Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ CPU throttling, Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ OOMKilled ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ, vertical pod autoscaler
- `kubectl logs <pod-name> --previous` - Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ñ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°, ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ² ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ Ğ¿Ğ¾Ğ´, kubectl debug <pod-name> -it --image=busybox --target=<container-name>

- scheduler:
```bash
# Pod'Ñ‹ Ñ resource requests
kubectl describe pod <argocd-server-pod> -n argocd | grep -A 5 "Requests:"
# Scheduler Ğ½Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑÑ‚Ğ¸Ñ‚ Pod, ĞµÑĞ»Ğ¸ Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
kubectl describe pod <pod-name> -n argocd | grep -A 10 "Events:"
# Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€
alexanderrodnin@MacBook-Air-3 infra % k describe pod argocd-server-84cdbdfb6-c26z6 -n argocd | grep -A 25 "Events"
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  17m   default-scheduler  Successfully assigned argocd/argocd-server-84cdbdfb6-c26z6 to ha-worker-pool-2nsdm
  Normal  Pulling    17m   kubelet            Pulling image "quay.io/argoproj/argocd:v2.10.1"
  Normal  Pulled     17m   kubelet            Successfully pulled image "quay.io/argoproj/argocd:v2.10.1" in 13.662s (13.662s including waiting). Image size: 169935379 bytes.
  Normal  Created    17m   kubelet            Created container: server
  Normal  Started    17m   kubelet            Started container server
  
  
## Affinity!
# ArgoCD Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ anti-affinity Ğ´Ğ»Ñ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ Node'Ğ°Ğ¼
kubectl describe pod <argocd-server-pod> -n argocd | grep -A 10 "Affinity:"

# Scheduler Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰Ğ°ĞµÑ‚ Pod'Ñ‹ Ğ½Ğ° Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Node'Ğ°Ñ…
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server -o wide

# Ğ”ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

# ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Pod - Scheduler Ğ²Ñ‹Ğ±ĞµÑ€ĞµÑ‚ Ğ»ÑĞ±ÑƒÑ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ÑƒÑ Node
kubectl run simple-pod --image=nginx
# ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ½Ğ° ĞºĞ°ĞºĞ¾Ğ¹ Node Ğ¿Ğ¾Ğ¿Ğ°Ğ»
kubectl get pod simple-pod -o wide
# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
kubectl describe pod simple-pod | grep -A 5 "Events:"
# ĞÑ‡Ğ¸ÑÑ‚ĞºĞ°
kubectl delete pod simple-pod
```

```bash
# Pod Ñ anti-affinity (Ğ½Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰Ğ°Ñ‚ÑŒ Ñ€ÑĞ´Ğ¾Ğ¼ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼Ğ¸ nginx Pod'Ğ°Ğ¼Ğ¸)
cat << EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: anti-affinity-pod
  labels:
    app: nginx
spec:
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values:
            - nginx
        topologyKey: kubernetes.io/hostname
  containers:
  - name: nginx
    image: nginx
EOF

# Scheduler Ñ€Ğ°Ğ·Ğ¼ĞµÑÑ‚Ğ¸Ñ‚ Ğ½Ğ° Node Ğ±ĞµĞ· Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… nginx Pod'Ğ¾Ğ²
kubectl get pods -l app=nginx -o wide

# ĞÑ‡Ğ¸ÑÑ‚ĞºĞ°
kubectl delete pod anti-affinity-pod
```

```bash
# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
kubectl get events --field-selector reason=Scheduled

# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
kubectl get events --field-selector reason=FailedScheduling

# ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°Ñ… Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
kubectl describe pod <pending-pod> | grep -A 10 "Events:"
```
Ğ²Ñ‹ÑÑĞ½Ğ¸Ñ‚ÑŒ ĞºĞ°ĞºĞ¾Ğµ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ±ÑƒĞ´ĞµÑ‚ ĞµÑĞ»Ğ¸ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² Ñ‡ĞµĞ¼ ĞµÑÑ‚ÑŒ Ğ¸ Ğ½Ğµ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ,
ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ VPA,

## Kubelet
ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ worker node.
Ğ¡Ğ²ÑĞ·ÑƒÑÑ‰ĞµĞµ Ğ·Ğ²ĞµĞ½Ğ¾ Ğ¼ĞµĞ¶Ğ´Ñƒ control plane Ğ¸ worker node.

- ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ°Ğ¼Ğ¸
- Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ CRI


## Kube-proxy
- ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ (Ğ½Ğ°ÑÑ‚Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞµÑ‚ĞµĞ²Ğ¾Ğµ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ)
- ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑÑ Ğ½Ğ° workder-node, Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¸ Ğ½Ğ° control-plane ĞµÑĞ»Ğ¸ Ñƒ Ğ½ĞµÑ‘ ÑÑ‚Ğ¾Ğ¸Ñ‚ taint
- Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸:
```bash
ClusterIP,
NodePort, 
LoadBalancer,
External Name (Ğ²Ñ‹ÑÑĞ½Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº ÑÑ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚)
```
- Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:
```bash
IpTables (Ğ¿Ğ¾-ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ) 
IPVS
```
- ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ **session affinity**


## Ğ¡Ğ±Ğ¾Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ¿Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼:
```bash
# Ğ›Ğ¾Ğ³Ğ¸ kube-proxy
kubectl logs -n kube-system -l k8s-app=kube-proxy

# Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Node
kubectl logs -n kube-system -l k8s-app=kube-proxy --field-selector spec.nodeName=<node-name>
```

## Controller Manager
**kube-controller-manager** â€” ÑÑ‚Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Control plane ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ¾Ğ² Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°. ĞšĞ ĞĞ¢ĞšĞ: Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¶ĞµĞ»Ğ°ĞµĞ¼Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°.

ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ¾Ğ² 
- Deployment Controller
- StatefulSet Controller
- Node Controller

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Controller Loop                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Watch API Server                                       â”‚
â”‚     â”œâ”€â”€ Monitor resource changes                           â”‚
â”‚     â”œâ”€â”€ Get current state                                  â”‚
â”‚     â””â”€â”€ Compare with desired state                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Reconcile                                              â”‚
â”‚     â”œâ”€â”€ Calculate diff                                     â”‚
â”‚     â”œâ”€â”€ Plan actions                                       â”‚
â”‚     â””â”€â”€ Execute changes                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Update Status                                          â”‚
â”‚     â”œâ”€â”€ Report back to API Server                          â”‚
â”‚     â”œâ”€â”€ Update resource status                             â”‚
â”‚     â””â”€â”€ Generate events                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. Repeat                                                 â”‚
â”‚     â””â”€â”€ Continue monitoring                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 17. Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ° Ğ¼ĞµĞ¶Ğ´Ñƒ kube-controller-manager Ğ¸ cloud-controller-manager
### **kube-controller-manager:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              kube-controller-manager                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Core Controllers:                                          â”‚
â”‚  â”œâ”€â”€ Deployment Controller                                  â”‚
â”‚  â”œâ”€â”€ ReplicaSet Controller                                  â”‚
â”‚  â”œâ”€â”€ DaemonSet Controller                                   â”‚
â”‚  â”œâ”€â”€ Job Controller                                         â”‚
â”‚  â”œâ”€â”€ CronJob Controller                                     â”‚
â”‚  â”œâ”€â”€ StatefulSet Controller                                 â”‚
â”‚  â”œâ”€â”€ Namespace Controller                                   â”‚
â”‚  â”œâ”€â”€ ServiceAccount Controller                              â”‚
â”‚  â”œâ”€â”€ Endpoint Controller                                    â”‚
â”‚  â”œâ”€â”€ ResourceQuota Controller                               â”‚
â”‚  â”œâ”€â”€ PersistentVolume Controller                            â”‚
â”‚  â””â”€â”€ Certificate Controller                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **cloud-controller-manager:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            cloud-controller-manager                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cloud-Specific Controllers:                                â”‚
â”‚  â”œâ”€â”€ Node Controller                                        â”‚
â”‚  â”‚   â”œâ”€â”€ Node lifecycle management                         â”‚
â”‚  â”‚   â”œâ”€â”€ Node labeling (zones, instance types)             â”‚
â”‚  â”‚   â””â”€â”€ Node deletion handling                            â”‚
â”‚  â”œâ”€â”€ Route Controller                                       â”‚
â”‚  â”‚   â”œâ”€â”€ Pod network routes                                â”‚
â”‚  â”‚   â””â”€â”€ Cross-node communication                          â”‚
â”‚  â”œâ”€â”€ Service Controller                                     â”‚
â”‚  â”‚   â”œâ”€â”€ LoadBalancer provisioning                         â”‚
â”‚  â”‚   â”œâ”€â”€ External IP assignment                            â”‚
â”‚  â”‚   â””â”€â”€ Cloud LB integration                              â”‚
â”‚  â””â”€â”€ Volume Controller                                      â”‚
â”‚      â”œâ”€â”€ PV provisioning                                   â”‚
â”‚      â”œâ”€â”€ Volume attachment/detachment                      â”‚
â”‚      â””â”€â”€ Storage class integration                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## **Lead Election**
ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ»Ğ¸Ğ´ĞµÑ€Ğ°

### **Control Plane ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:**
```bash
# kube-controller-manager Ğ² HA Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ
kubectl describe lease kube-controller-manager -n kube-system

# kube-scheduler Ğ² HA Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ  
kubectl describe lease kube-scheduler -n kube-system

# Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½
```

### **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸:**
- leaseDurationSeconds: 15-30 ÑĞµĞºÑƒĞ½Ğ´
- renewDeadline: 10-20 ÑĞµĞºÑƒĞ½Ğ´
- retryPeriod: 2-5 ÑĞµĞºÑƒĞ½Ğ´
- Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¼ failover Ğ¸ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒÑ



## **Container runtime interfase (CRI)**
ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ API Ğ¼ĞµĞ¶Ğ´Ñƒ kubelet Ğ¸ container runtime.   
Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ POD-Ñ‹  

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        kubelet                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CRI Client                                                â”‚
â”‚  â”œâ”€â”€ RuntimeService Client                                 â”‚
â”‚  â”‚   â”œâ”€â”€ RunPodSandbox()                                   â”‚
â”‚  â”‚   â”œâ”€â”€ StopPodSandbox()                                  â”‚
â”‚  â”‚   â”œâ”€â”€ CreateContainer()                                 â”‚
â”‚  â”‚   â”œâ”€â”€ StartContainer()                                  â”‚
â”‚  â”‚   â”œâ”€â”€ StopContainer()                                   â”‚
â”‚  â”‚   â””â”€â”€ RemoveContainer()                                 â”‚
â”‚  â””â”€â”€ ImageService Client                                   â”‚
â”‚      â”œâ”€â”€ PullImage()                                       â”‚
â”‚      â”œâ”€â”€ RemoveImage()                                     â”‚
â”‚      â”œâ”€â”€ ImageStatus()                                     â”‚
â”‚      â””â”€â”€ ListImages()                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# **Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² K8s**
## **Ğ’Ñ‹Ğ±Ğ¾Ñ€ API Ğ²ĞµÑ€ÑĞ¸Ğ¹:**
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ stable (v1) Ğ´Ğ»Ñ production
- Ğ˜Ğ·Ğ±ĞµĞ³Ğ°Ğ¹Ñ‚Ğµ alpha Ğ² production
- Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ beta Ğ²ĞµÑ€ÑĞ¸Ğ¸
- Ğ¡Ğ»ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ° deprecation notices

# Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ¸Ğ½Ğµ Pod-ami

### Init-containers
- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ² ÑĞ»ÑƒÑ‡Ğ°Ğµ ÑƒĞ´Ğ°Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾
- ĞŸÑ€Ğ¸ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑÑ‚ÑÑ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾
- Ğ”Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ¸Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ñ‹
- Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ retry Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ
- Ñƒ Ğ½Ğ¸Ñ… Ğ¾Ğ±Ñ‰Ğ¸Ğµ volume, Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ - Ñ€Ğ°Ğ·Ğ½Ğ¾Ğµ

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ: (Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ° Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ¾Ğ², Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ² volume)
- Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ (ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»ÑÑ‡ĞµĞ¹, ÑĞµĞºÑŒÑÑ€Ğ¸Ñ‚Ğ¸ Ñ‡ĞµĞºĞ¸)
- Ğ±Ğ°Ğ·Ñ‹ (Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ°Ğ·Ñ‹)
- Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
- Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹

# Multicontainer pods
ĞŸĞ¾Ğ´Ñ‹ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‰Ğ¸Ğµ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ², ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ²Ğ¼ĞµÑÑ‚Ğµ ĞºĞ°Ğº ĞµĞ´Ğ¸Ğ½Ğ¾Ğµ Ñ†ĞµĞ»Ğ¾Ğµ. Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑÑÑ‚ ÑĞµÑ‚ÑŒ, envs, storage Ğ¸ Ğ¶Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ».

ĞšĞ»Ğ°ÑÑÑ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
- sidecar (Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµÑ‚ Ğ¸Ğ»Ğ¸ ÑƒĞ»ÑƒÑ‡ÑˆĞ°ĞµÑ‚ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°. Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Istio Envoy Proxy â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ² Pod, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¸ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº (mTLS))
- ambassador (Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ². Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ ĞºĞ¾Ğ³Ğ´Ğ° ĞºÑ‚Ğ¾-Ñ‚Ğ¾ ÑĞ½Ğ°Ñ€ÑƒĞ¶Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ² Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ Ğ¸ Ğ¼Ñ‹ Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ñˆ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚)
- adapter (Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¸Ñ‚ĞµĞ»ĞµĞ¹. Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ ĞºĞ¾Ğ³Ğ´Ğ° ĞºÑ‚Ğ¾-Ñ‚Ğ¾ ÑĞ½Ğ°Ñ€ÑƒĞ¶Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ğ² Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ)

# **Resource Requests Ğ¸ Limits**
ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼Ğ¸ Ğ² K8s. Requests - Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ², Limits - Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ².  

ĞŸÑ€Ğ¸ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸Ğ¸ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ¾Ğ² Ğ¿Ğ¾:
- Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğµ OOMKiller (Out of Memory Killer)
- Ğ¿Ñ€Ğ¸ Ğ¿Ñ€Ğ¸Ğ²Ñ‹ÑˆĞµĞ½Ğ¸Ğ¸ Ğ¿Ğ¾ CPU - Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ°ĞµÑ‚ throatling


# **Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸ Ğ½ĞµÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‰ĞµĞ³Ğ¾ Pod**
```bash
# Ğ¨Ğ°Ğ³ 1 - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°:
kubectl describe pod

# Ğ¨Ğ°Ğ³ 2 - ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹:
# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ Pod'Ğ°
kubectl get events --field-selector involvedObject.name=<pod-name>
# Ğ’ÑĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ² namespace
kubectl get events -n <namespace> --sort-by=.metadata.creationTimestamp
# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ñ… 1 Ñ‡Ğ°ÑĞ°
kubectl get events --field-selector involvedObject.name=<pod-name> --sort-by=.metadata.creationTimestamp | grep "$(date -d '1 hour ago' '+%Y-%m-%d')"

# Ğ¨Ğ°Ğ³ 3 - Ğ˜Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ¾Ğ²
# Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ¸
kubectl logs <pod-name>
# Ğ›Ğ¾Ğ³Ğ¸ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
kubectl logs <pod-name> -c <container-name>
# ĞŸÑ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ¸ (Ğ¿Ñ€Ğ¸ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ğµ)
kubectl logs <pod-name> --previous
# Ğ¡Ğ»ĞµĞ´Ğ¸Ñ‚ÑŒ Ğ·Ğ° Ğ»Ğ¾Ğ³Ğ°Ğ¼Ğ¸ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
kubectl logs <pod-name> -f
# Ğ›Ğ¾Ğ³Ğ¸ Ğ²ÑĞµÑ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²
kubectl logs <pod-name> --all-containers=true

# Ğ¨Ğ°Ğ³ 4 - Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ°
# Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ Ğ² Pod'Ğµ
kubectl exec <pod-name> -- <command>
# Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ ÑĞµÑÑĞ¸Ñ
kubectl exec -it <pod-name> -- /bin/bash
# Ğ”Ğ»Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
kubectl exec -it <pod-name> -c <container-name> -- /bin/sh
# ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
kubectl cp <pod-name>:/path/to/file ./local-file
kubectl cp ./local-file <pod-name>:/path/to/file
```

```bash
# Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ ÑƒĞ¿Ğ°Ğ²ÑˆĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ´Ğ°:
kubectl logs <pod-name> -p
```

Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹:
- ImagePullBackOff / ErrImagePull
- CrashLoopBackOff
- Pending Pod'Ñ‹ (Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚)
- OOMKilled Pod'Ñ‹

### **Debug ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹ (Kubernetes 1.23+):**
```bash
# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ debug ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğº ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¼Ñƒ Pod'Ñƒ
kubectl debug <pod-name> -it --image=busybox --target=<container-name>
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¿Ğ¸Ñ Pod'Ğ° Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
kubectl debug <pod-name> -it --copy-to=debug-pod --container=debug --image=busybox
```


## **Pos security context**  
[Pos security context ](./03-Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ%20Pod-Ğ°Ğ¼Ğ¸/025-Ñ‡Ñ‚Ğ¾-Ñ‚Ğ°ĞºĞ¾Ğµ-pod-security-contexts.md)

**k8s security context** - Ğ½Ğ°Ğ±Ğ¾Ñ€ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸, Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµĞ¼Ñ‹Ñ… Ğº POD-Ñƒ Ğ¸Ğ»Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñƒ.  ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°, Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹, Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹, capabilities Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿ÑĞ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ².

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Security Context

#### User Ğ¸ Group ID
- runAsUser - UID Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- runAsGroup - GID Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹
- runAsNonRoot - Ğ·Ğ°Ğ¿Ñ€ĞµÑ‚ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¾Ñ‚ root
- fsGroup - Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ° Ğ´Ğ»Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

#### Capabilities
- add - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Linux capablities
- drop - ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Linux capabilities
- ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ²ĞµĞ»ĞµĞ³Ğ¸Ğ¹

#### SELinux/AppArmor
- seLinuxOptions - Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° SELinux
- appArmorProfile - Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ AppArmor
- seccompProfile - Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ seccomp

#### Priveleged Ñ€ĞµĞ¶Ğ¸Ğ¼ (ĞĞ•Ğ›Ğ¬Ğ—Ğ¯ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¿Ñ€Ğ¾Ğ´Ğµ)
- priveleged - Ğ¿Ñ€Ğ¸Ğ²ĞµĞ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
- allowPrivilegeEscalation - Ñ€ĞµĞ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ²Ñ‹ÑˆĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹ 
- readOnlyRootFilesystem - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ Ğ¤Ğ¡

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° security context
```bash
kubectl get pods -A -o jsonpath='{range .items[*]}{.metadata.name}{"\n"}{.spec.securityContext}{"\n"}{range .spec.containers[*]}{.name}: {.securityContext}{"\n"}{end}{"\n"}{end}'
```


## **Container restarts**
ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ K8s Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ° container-Ğ¾Ğ² Ğ² ÑĞ»ÑƒÑ‡Ğ°Ğµ ÑĞ±Ğ¾Ñ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğ¸
- always (Ğ¿Ğ¾-ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ) (Ğ²ÑĞµĞ³Ğ´Ğ°, Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ deployment, statefull set)
- on failure (Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ Job, Batch Job) (ÑÑ‚Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ² ÑĞ»ÑƒÑ‡Ğ°Ğµ exit code != 0)
- never Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ Ğ¾Ğ´Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡

## **Quality of service - QoS**
**QoS** - ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ĞºĞ²Ğ°Ğ»Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ POD-Ğ¾Ğ² Ğ² k8s Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ¸Ñ… resource requests Ğ¸ resource limits. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµÑĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ¾Ñ€ĞµÑ‚ĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¾Ğ² Ğ¿Ñ€Ğ¸ Ğ½ĞµÑ…Ğ²Ğ°Ñ‚ĞºĞµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² Ğ¸ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ ĞºĞ°ĞºĞ¸Ğµ Ğ¸Ğ· Ğ¿Ğ¾Ğ´Ğ¾Ğ² Ğ±ÑƒĞ´ÑƒÑ‚ evicted Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼Ğ¸.

Ğ’Ğ¾Ñ‚ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ Ğ² Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ:
- **Guarantee** (requests == limits)
- **Burstable** (requests < limits)
- **BestEffort** (requests Ğ¸ limits Ğ½Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ñ‹)

```bash
# Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ QoS
kubectl get pods -A -o custom-columns=NAME:.metadata.name,QOS:.status.qosClass
```

## **Liveness Ğ¸ Readiness probes**

**Health probes** - Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ k8s Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²

- **Liveness Probe** (ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚, Ñ‡Ñ‚Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, ĞŸÑ€Ğ¸ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ, ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ "Ğ·Ğ°Ğ²Ğ¸ÑÑˆĞ¸Ğµ" ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹)
- **Readiness Probe** (ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº, ĞŸÑ€Ğ¸ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğµ Pod Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğ¸Ğ· Service, ĞĞµ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°)
- **Startup Probe (Kubernetes 1.16+)** (ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°, ĞÑ‚ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ liveness/readiness Ğ´Ğ¾ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°, ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚ÑƒÑÑ‰Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹)

**TODO**: ÑÑ‚Ğ¾ Ğ¶Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ¸ ĞºĞ°Ğº Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‚Ğ°Ğº Ğ¸ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ k8s (Ğ¸Ğ»Ğ¸ Ñ Ñ‡ĞµĞ³Ğ¾-Ñ‚Ğ¾ Ğ½Ğµ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ñ)  

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€                           | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|------------------------------------|----------|
| **initialDelaySeconds**            | Ğ’Ñ€ĞµĞ¼Ñ (Ğ² ÑĞµĞºÑƒĞ½Ğ´Ğ°Ñ…) Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ´ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ Ğ¿Ğ¾ÑĞ»Ğµ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°. |
| **periodSeconds**                  | Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» (Ğ² ÑĞµĞºÑƒĞ½Ğ´Ğ°Ñ…) Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°Ğ¼Ğ¸. |
| **timeoutSeconds**                 | Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸, Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ¾Ğ½Ğ° ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ½ĞµÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹. |
| **successThreshold**                | ĞšĞ¾Ğ»-Ğ²Ğ¾ Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° â€œĞ·Ğ´Ğ¾Ñ€Ğ¾Ğ²Ñ‹Ğ¼â€ (Ğ´Ğ»Ñ readiness Ğ¸ startup). |
| **failureThreshold**                | ĞšĞ¾Ğ»-Ğ²Ğ¾ Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° â€œĞ½ĞµĞ·Ğ´Ğ¾Ñ€Ğ¾Ğ²Ñ‹Ğ¼â€. |
| **httpGet**                         | HTTP-Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ (`path`, `port`, `host`, `scheme`, `httpHeaders`). |
| **tcpSocket**                       | TCP-Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¾Ñ€Ñ‚Ğ° (`port`, `host`). |
| **exec**                            | Ğ—Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ (`command`). |
| **terminationGracePeriodSeconds**   | (ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾) Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¶Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»Ğµ SIGTERM Ğ¿ĞµÑ€ĞµĞ´ Ğ¿Ñ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸ĞµĞ¼, ĞµÑĞ»Ğ¸ probe Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ğ», Ñ‡Ñ‚Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ½ĞµĞ·Ğ´Ğ¾Ñ€Ğ¾Ğ². |

## **Pod Disruption Budget**

**PBB** - ÑÑ‚Ğ¾ Ñ€ĞµÑÑƒÑ€Ñ K8s, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾Ğ´Ğ¾Ğ² ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¼Ğ¾Ğ³ÑƒÑ‚Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ voluntary disruptions (Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ²Ñ‹Ñ… (Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ²Ñ‹Ñ…!) Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğ¹). PDB Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚ HA Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹.  

**Voluntary Disruption** (ĞŸĞ»Ğ°Ğ½Ğ¾Ğ²Ñ‹Ğµ):
- Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Deployment-Ğ¾Ğ²
- Drain Node-Ğ¾Ğ² Ğ´Ğ»Ñ Ğ¾Ğ±ÑĞ»ÑƒĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ
- ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°
- ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Node-Ğ¾Ğ²

### ğŸ”¹ Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ñ€Ğ¸ drain
1. **Ğ¡Ñ‚Ğ°Ğ²Ğ¸Ñ‚ÑÑ taint** `node.kubernetes.io/unschedulable:NoSchedule`  
   â†’ Ğ½Ğ¾Ğ²Ñ‹Ğµ Podâ€™Ñ‹ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ½Ğµ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ½Ğ° ÑÑ‚Ñƒ Ğ½Ğ¾Ğ´Ñƒ.
2. Kubernetes **ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµÑ‚ Podâ€™Ñ‹**, Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰Ğ°Ñ Ğ¸Ñ… Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ½Ğ¾Ğ´Ñ‹:
    - Ğ£Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ `PodDisruptionBudget` (PDB)
    - Ğ£Ğ²Ğ°Ğ¶Ğ°ĞµÑ‚ `terminationGracePeriodSeconds`
3. **Podâ€™Ñ‹ Ñ `replicaSet` Ğ¸Ğ»Ğ¸ `deployment`** Ğ¿ĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ÑÑ Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ½Ğ¾Ğ´Ğ°Ñ….
4. **Podâ€™Ñ‹ Ğ±ĞµĞ· ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ¾Ğ²** (standalone) ÑƒĞ´Ğ°Ğ»ÑÑÑ‚ÑÑ Ğ¸ **Ğ½Ğµ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ**.

### ğŸ”¹ ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ´Ğ»Ñ drain
```bash
kubectl drain <node-name>
```

### ğŸ“‹ ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ PodDisruptionBudget (PDB)

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€             | Ğ¢Ğ¸Ğ¿     | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------------------|---------|----------|
| **minAvailable**     | string / int | ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Podâ€™Ğ¾Ğ², ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¼ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ¾Ğ±Ñ€Ğ¾Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ğº (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚). |
| **maxUnavailable**   | string / int | ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Podâ€™Ğ¾Ğ², ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ¾Ğ±Ñ€Ğ¾Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ğº (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚). |
| **selector**         | object  | ĞœĞµÑ‚ĞºĞ° (`label selector`), Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑÑÑ‰Ğ°Ñ, Ğº ĞºĞ°ĞºĞ¸Ğ¼ Podâ€™Ğ°Ğ¼ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ PDB. |
| **unhealthyPodEvictionPolicy** | string | ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Podâ€™Ğ¾Ğ², Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ…ÑÑ Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ `NotReady` (`AlwaysAllow` Ğ¸Ğ»Ğ¸ `IfHealthyBudget`). ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ â€” `IfHealthyBudget`. |


## DNS Ğ´Ğ»Ñ POD-Ğ¾Ğ²

**DNS Ğ² K8s** - ÑÑ‚Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ¸Ğ¼ĞµĞ½, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Pod-Ğ¾Ğ¼ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ° Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ¿Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ°Ğ¼ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ IP-Ğ°Ğ´Ñ€ĞµÑĞ¾Ğ². Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ coredns.

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:
```bash
# DNS Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ´Ğ»Ñ Service:
# web-service.default.svc.cluster.local (Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ Ğ¸Ğ¼Ñ)
# web-service.default.svc (Ğ±ĞµĞ· Ğ´Ğ¾Ğ¼ĞµĞ½Ğ° ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°)
# web-service.default (Ğ±ĞµĞ· svc)
# web-service (Ğ² Ñ‚Ğ¾Ğ¼ Ğ¶Ğµ namespace)
```


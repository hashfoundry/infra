# 10. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É StatefulSet –∏ Deployment?

## üéØ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è:**

| –ê—Å–ø–µ–∫—Ç | Deployment | StatefulSet |
|--------|------------|-------------|
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | Stateless –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | Stateful –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| **–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å Pod'–æ–≤** | –í–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ | –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å |
| **–ò–º–µ–Ω–∞ Pod'–æ–≤** | –°–ª—É—á–∞–π–Ω—ã–µ —Å—É—Ñ—Ñ–∏–∫—Å—ã | –ü–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ |
| **–ü–æ—Ä—è–¥–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è** | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ |
| **–•—Ä–∞–Ω–∏–ª–∏—â–µ** | –û–±—â–∏–µ volumes | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ PVC |
| **–°–µ—Ç–µ–≤–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å** | –ù–µ—Ç | –°—Ç–∞–±–∏–ª—å–Ω–∞—è |
| **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è** | Rolling update | –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

## üì¶ **Deployment (–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)**

**Deployment** ‚Äî —ç—Ç–æ —Ä–µ—Å—É—Ä—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è stateless –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –≥–¥–µ –≤—Å–µ Pod'—ã –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã.

### **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ Deployment:**
- Pod'—ã **–∏–¥–µ–Ω—Ç–∏—á–Ω—ã** –∏ **–≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã**
- **–°–ª—É—á–∞–π–Ω—ã–µ –∏–º–µ–Ω–∞** Pod'–æ–≤
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ** —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
- **–û–±—â–∏–µ volumes** (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **web —Å–µ—Ä–≤–µ—Ä–æ–≤**, **API**, **–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤**

## üóÑÔ∏è **StatefulSet (–°–æ—Å—Ç–æ—è–Ω–∏–µ)**

**StatefulSet** ‚Äî —ç—Ç–æ —Ä–µ—Å—É—Ä—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è stateful –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –≥–¥–µ –∫–∞–∂–¥—ã–π Pod –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å.

### **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ StatefulSet:**
- Pod'—ã –∏–º–µ—é—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å**
- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –∏–º–µ–Ω–∞** Pod'–æ–≤ (app-0, app-1, app-2)
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ** —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
- **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ PVC** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Pod'–∞
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **–±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**, **–æ—á–µ—Ä–µ–¥–µ–π**, **–∫–ª–∞—Å—Ç–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**

## üìä **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ HA –∫–ª–∞—Å—Ç–µ—Ä–∞:**

### **1. Deployment –ø—Ä–∏–º–µ—Ä—ã (ArgoCD):**
```bash
# ArgoCD Server - stateless –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
kubectl get deployment argocd-server -n argocd

# Pod'—ã –∏–º–µ—é—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Å—É—Ñ—Ñ–∏–∫—Å—ã
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server

# ReplicaSet —É–ø—Ä–∞–≤–ª—è–µ—Ç Pod'–∞–º–∏
kubectl get replicasets -n argocd -l app.kubernetes.io/name=argocd-server

# –í—Å–µ Pod'—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –∏ –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã
kubectl describe deployment argocd-server -n argocd | grep -A 5 "Replicas:"
```

### **2. StatefulSet –ø—Ä–∏–º–µ—Ä—ã (Redis HA):**
```bash
# Redis HA - stateful –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
kubectl get statefulsets -n argocd

# Pod'—ã –∏–º–µ—é—Ç –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞
kubectl get pods -n argocd -l app=redis-ha

# –ö–∞–∂–¥—ã–π Pod –∏–º–µ–µ—Ç —Å–≤–æ–π PVC
kubectl get pvc -n argocd | grep redis

# Headless Service –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Å–µ—Ç–µ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
kubectl get svc -n argocd | grep redis
```

### **3. Prometheus –∫–∞–∫ StatefulSet:**
```bash
# Prometheus –æ–±—ã—á–Ω–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ StatefulSet
kubectl get statefulsets -n monitoring

# Prometheus Pod —Å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏–º–µ–Ω–µ–º
kubectl get pods -n monitoring -l app.kubernetes.io/name=prometheus

# Persistent storage –¥–ª—è –¥–∞–Ω–Ω—ã—Ö Prometheus
kubectl get pvc -n monitoring | grep prometheus
```

## üîÑ **–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ —É–¥–∞–ª–µ–Ω–∏–∏:**

### **1. Deployment - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ:**
```bash
# –°–æ–∑–¥–∞—Ç—å Deployment
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: nginx
        image: nginx
EOF

# –í—Å–µ Pod'—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
kubectl get pods -l app=web --watch

# –ò–º–µ–Ω–∞ Pod'–æ–≤ —Å–ª—É—á–∞–π–Ω—ã–µ
kubectl get pods -l app=web -o name
```

### **2. StatefulSet - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ:**
```bash
# –°–æ–∑–¥–∞—Ç—å StatefulSet
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web-statefulset
spec:
  serviceName: web-headless
  replicas: 3
  selector:
    matchLabels:
      app: web-stateful
  template:
    metadata:
      labels:
        app: web-stateful
    spec:
      containers:
      - name: nginx
        image: nginx
  volumeClaimTemplates:
  - metadata:
      name: data
    spec:
      accessModes: ["ReadWriteOnce"]
      resources:
        requests:
          storage: 1Gi
EOF

# Pod'—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É: web-statefulset-0, –∑–∞—Ç–µ–º web-statefulset-1, –∑–∞—Ç–µ–º web-statefulset-2
kubectl get pods -l app=web-stateful --watch

# –ò–º–µ–Ω–∞ Pod'–æ–≤ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ
kubectl get pods -l app=web-stateful -o name
```

### **3. Headless Service –¥–ª—è StatefulSet:**
```bash
# –°–æ–∑–¥–∞—Ç—å Headless Service
cat << EOF | kubectl apply -f -
apiVersion: v1
kind: Service
metadata:
  name: web-headless
spec:
  clusterIP: None
  selector:
    app: web-stateful
  ports:
  - port: 80
EOF

# –ö–∞–∂–¥—ã–π Pod –ø–æ–ª—É—á–∞–µ—Ç DNS –∑–∞–ø–∏—Å—å
kubectl run test-dns --image=busybox -it --rm -- nslookup web-statefulset-0.web-headless.default.svc.cluster.local
```

### **4. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤:**
```bash
kubectl delete deployment web-deployment
kubectl delete statefulset web-statefulset
kubectl delete service web-headless
kubectl delete pvc -l app=web-stateful
```

## üíæ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:**

### **1. Deployment —Å –æ–±—â–∏–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:**
```bash
# Deployment –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ volumes
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: shared-storage-deployment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: shared-app
  template:
    metadata:
      labels:
        app: shared-app
    spec:
      containers:
      - name: app
        image: nginx
        volumeMounts:
        - name: shared-data
          mountPath: /data
      volumes:
      - name: shared-data
        persistentVolumeClaim:
          claimName: shared-pvc
EOF

# –í—Å–µ Pod'—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω PVC
kubectl describe deployment shared-storage-deployment | grep -A 10 "Volumes:"

# –û—á–∏—Å—Ç–∫–∞
kubectl delete deployment shared-storage-deployment
```

### **2. StatefulSet —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:**
```bash
# StatefulSet –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç PVC –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Pod'–∞
kubectl get statefulset web-statefulset -o yaml | grep -A 10 "volumeClaimTemplates:"

# –ö–∞–∂–¥—ã–π Pod –∏–º–µ–µ—Ç —Å–≤–æ–π PVC
kubectl get pvc | grep web-statefulset

# PVC –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º Pod'–∞–º
kubectl describe pvc data-web-statefulset-0
```

## üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### **1. Deployment –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
# Rolling update - Pod'—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
kubectl set image deployment/argocd-server -n argocd argocd-server=argoproj/argocd:v2.9.0

# –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
kubectl rollout status deployment/argocd-server -n argocd

# –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
kubectl rollout history deployment/argocd-server -n argocd

# –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
kubectl rollout undo deployment/argocd-server -n argocd
```

### **2. StatefulSet –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
# –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ - Pod'—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É
kubectl get statefulsets -n argocd -o yaml | grep updateStrategy -A 5

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ Pod'–∞ (highest ordinal)
kubectl describe statefulset <redis-statefulset> -n argocd | grep -A 5 "Update Strategy:"

# –ú–æ–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
kubectl patch statefulset <redis-statefulset> -n argocd -p '{"spec":{"updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":1}}}}'
```

### **3. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# Deployment - –±—ã—Å—Ç—Ä–æ–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
kubectl scale deployment argocd-server --replicas=5 -n argocd

# StatefulSet - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
kubectl scale statefulset <redis-statefulset> --replicas=5 -n argocd

# –ü—Ä–∏ —É–º–µ–Ω—å—à–µ–Ω–∏–∏ StatefulSet —É–¥–∞–ª—è–µ—Ç Pod'—ã –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
kubectl scale statefulset <redis-statefulset> --replicas=2 -n argocd
```

## üè≠ **–ü—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ HA –∫–ª–∞—Å—Ç–µ—Ä–∞:**

### **1. ArgoCD –∫–∞–∫ Deployment (stateless):**
```bash
# ArgoCD Server - stateless, –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
kubectl get deployment argocd-server -n argocd -o yaml | grep -A 5 "replicas:"

# ArgoCD Controller - stateless, –Ω–æ –æ–±—ã—á–Ω–æ 1-2 —Ä–µ–ø–ª–∏–∫–∏
kubectl get deployment argocd-application-controller -n argocd

# Repo Server - stateless, –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å
kubectl get deployment argocd-repo-server -n argocd

# –í—Å–µ Pod'—ã –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã
kubectl get pods -n argocd -l app.kubernetes.io/part-of=argocd -o wide
```

### **2. Redis HA –∫–∞–∫ StatefulSet (stateful):**
```bash
# Redis HA —Ç—Ä–µ–±—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
kubectl get statefulsets -n argocd

# –ö–∞–∂–¥—ã–π Redis Pod –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Ä–æ–ª—å (master/slave)
kubectl get pods -n argocd -l app=redis-ha

# Persistent storage –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Redis Pod'–∞
kubectl get pvc -n argocd | grep redis

# Headless Service –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
kubectl get svc -n argocd | grep redis
```

### **3. Prometheus –∫–∞–∫ StatefulSet (stateful):**
```bash
# Prometheus —Ö—Ä–∞–Ω–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö
kubectl get statefulsets -n monitoring

# Persistent storage –¥–ª—è –¥–∞–Ω–Ω—ã—Ö Prometheus
kubectl get pvc -n monitoring | grep prometheus

# –°—Ç–∞–±–∏–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –¥–ª—è scraping
kubectl get pods -n monitoring -l app.kubernetes.io/name=prometheus
```

## üîß **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ:**

### **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Deployment –¥–ª—è:**
- **Web —Å–µ—Ä–≤–µ—Ä–æ–≤** (nginx, Apache)
- **API —Å–µ—Ä–≤–µ—Ä–æ–≤** (REST, GraphQL)
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤** –±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∑–∞–¥–∞—á** (workers)
- **–ü—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤** (envoy, haproxy)

```bash
# –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞:
kubectl get deployments -n argocd    # ArgoCD –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
kubectl get deployments -n monitoring # Grafana
kubectl get deployments -n ingress-nginx # NGINX Ingress
```

### **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ StatefulSet –¥–ª—è:**
- **–ë–∞–∑ –¥–∞–Ω–Ω—ã—Ö** (PostgreSQL, MySQL, MongoDB)
- **–û—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π** (RabbitMQ, Kafka)
- **–ö–ª–∞—Å—Ç–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** (Elasticsearch, Redis Cluster)
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å persistent storage**
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ç—Ä–µ–±—É—é—â–∏—Ö —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Å–µ—Ç–µ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏**

```bash
# –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞:
kubectl get statefulsets -n argocd     # Redis HA
kubectl get statefulsets -n monitoring # Prometheus
```

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–ª–∏—á–∏–π:**

### **1. Prometheus –º–µ—Ç—Ä–∏–∫–∏:**
```bash
# Port forward –∫ Prometheus
kubectl port-forward svc/prometheus-server -n monitoring 9090:80

# –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Deployment:
# kube_deployment_status_replicas
# kube_deployment_status_replicas_available
# kube_deployment_status_replicas_updated

# –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è StatefulSet:
# kube_statefulset_status_replicas
# kube_statefulset_status_replicas_ready
# kube_statefulset_status_current_revision
```

### **2. Grafana –¥–∞—à–±–æ—Ä–¥—ã:**
```bash
# Port forward –∫ Grafana
kubectl port-forward svc/grafana -n monitoring 3000:80

# –î–∞—à–±–æ—Ä–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
# - Deployment rolling updates
# - StatefulSet ordered updates
# - PVC usage –ø–æ StatefulSet'–∞–º
```

## üéØ **Best Practices:**

### **1. –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞:**
```bash
# –ó–∞–¥–∞–π—Ç–µ —Å–µ–±–µ –≤–æ–ø—Ä–æ—Å—ã:
# - –ù—É–∂–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é persistent storage? ‚Üí StatefulSet
# - –í–∞–∂–µ–Ω –ª–∏ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞? ‚Üí StatefulSet  
# - –ù—É–∂–Ω–∞ –ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å? ‚Üí StatefulSet
# - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ stateless? ‚Üí Deployment
```

### **2. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ labels:**
```bash
# Deployment
app.kubernetes.io/name: web-server
app.kubernetes.io/component: frontend

# StatefulSet  
app.kubernetes.io/name: database
app.kubernetes.io/component: storage
```

### **3. –†–µ—Å—É—Ä—Å—ã –∏ –ª–∏–º–∏—Ç—ã:**
```bash
# Deployment - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –≤—Å–µ—Ö Pod'–æ–≤
resources:
  requests:
    cpu: 100m
    memory: 128Mi

# StatefulSet - –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
# –¥–ª—è master/slave –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
```

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    HA Kubernetes Cluster                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Stateless Applications (Deployments)                      ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ ArgoCD Server (3 replicas) - –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ         ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ ArgoCD Controller (2 replicas) - –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ NGINX Ingress - load balancing                        ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Grafana - dashboard server                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Stateful Applications (StatefulSets)                      ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Redis HA (3 replicas) - master/slave —Ä–æ–ª–∏            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Prometheus - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö                    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Databases - persistent data                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Storage                                                    ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Shared PVC - –¥–ª—è Deployment'–æ–≤                        ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Individual PVC - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ StatefulSet Pod'–∞        ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ NFS - –¥–ª—è ReadWriteMany                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Deployment –¥–ª—è stateless, StatefulSet –¥–ª—è stateful ‚Äî –≤—ã–±–∏—Ä–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–¥–∞—á–∏!**

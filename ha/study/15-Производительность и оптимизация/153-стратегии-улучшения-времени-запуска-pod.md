# 153. –ö–∞–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç —É–ª—É—á—à–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ Pod?

## üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ Pod?**

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ Pod** ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å –º–µ—Ä –ø–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è Pod –¥–æ –µ–≥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤. –í–∫–ª—é—á–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –æ–±—Ä–∞–∑–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø—Ä–æ–≤–µ—Ä–æ–∫ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

## üèóÔ∏è **–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∑–∞–ø—É—Å–∫–∞ Pod:**

### **1. Scheduling (–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)**
- –í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —É–∑–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ affinity/anti-affinity –ø—Ä–∞–≤–∏–ª

### **2. Image Pulling (–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞)**
- –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–∑–∞ –∏–∑ registry
- –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Å–ª–æ–µ–≤ –æ–±—Ä–∞–∑–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É–∑–ª–µ

### **3. Container Startup (–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)**
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ volumes
- –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **4. Readiness (–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å)**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ Service

## üìä **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ HA –∫–ª–∞—Å—Ç–µ—Ä–∞:**

### **1. –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥–æ–≤:**
```bash
# –ê–Ω–∞–ª–∏–∑ —Å–æ–±—ã—Ç–∏–π –∑–∞–ø—É—Å–∫–∞ ArgoCD
kubectl get events -n argocd --sort-by=.metadata.creationTimestamp | grep -E "(Scheduled|Pulling|Pulled|Started|Ready)"

# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
kubectl get events -n monitoring --sort-by=.metadata.creationTimestamp | grep -E "(Scheduled|Pulling|Pulled|Started)"

# –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞
kubectl get events --all-namespaces --sort-by=.metadata.creationTimestamp | grep -E "(Scheduled|Pulling|Pulled|Started)" | tail -20
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ–∫—É—â–∏—Ö –ø–æ–¥–æ–≤:**
```bash
# –°—Ç–∞—Ç—É—Å –ø–æ–¥–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
kubectl get pods --all-namespaces -o wide --sort-by=.metadata.creationTimestamp

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—É—Å–∫–µ ArgoCD
kubectl describe pods -n argocd -l app.kubernetes.io/name=argocd-server | grep -A 10 "Events:"

# –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Prometheus
kubectl describe pods -n monitoring -l app.kubernetes.io/name=prometheus | grep -A 15 "Conditions:"
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:**
```bash
# –û–±—Ä–∞–∑—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ ArgoCD
kubectl get pods -n argocd -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}' | sort | uniq

# –û–±—Ä–∞–∑—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
kubectl get pods -n monitoring -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}' | sort | uniq

# –ü–æ–ª–∏—Ç–∏–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤
kubectl get pods --all-namespaces -o jsonpath='{range .items[*]}{.metadata.namespace}{"\t"}{.metadata.name}{"\t"}{.spec.containers[*].imagePullPolicy}{"\n"}{end}' | head -10
```

### **4. –ê–Ω–∞–ª–∏–∑ health checks –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ ArgoCD
kubectl get pods -n argocd -o yaml | grep -A 10 "readinessProbe"

# –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
kubectl get pods -n monitoring -o yaml | grep -A 10 "readinessProbe"

# Startup probes –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
kubectl get pods --all-namespaces -o yaml | grep -A 5 "startupProbe" | head -20
```

### **5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ NGINX Ingress:**
```bash
# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ NGINX Ingress Controller
kubectl describe pods -n ingress-nginx -l app.kubernetes.io/name=ingress-nginx | grep -A 10 "Events:"

# –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Ingress
kubectl get pods -n ingress-nginx -o yaml | grep -A 10 "readinessProbe"
```

## üîÑ **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ –∑–∞–ø—É—Å–∫–∞—é—â–µ–≥–æ—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
# –°–æ–∑–¥–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: fast-startup-app
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      app: fast-startup
  template:
    metadata:
      labels:
        app: fast-startup
    spec:
      containers:
      - name: app
        image: nginx:alpine  # –õ–µ–≥–∫–∏–π –æ–±—Ä–∞–∑
        imagePullPolicy: IfNotPresent  # –ò–∑–±–µ–≥–∞–µ–º –ª–∏—à–Ω–∏—Ö —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
        ports:
        - containerPort: 80
        resources:
          requests:
            cpu: 50m
            memory: 64Mi
          limits:
            cpu: 200m
            memory: 128Mi
        # –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 2
          periodSeconds: 2
          timeoutSeconds: 1
          successThreshold: 1
          failureThreshold: 3
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 10
          periodSeconds: 10
          timeoutSeconds: 3
          failureThreshold: 3
      # –ë—ã—Å—Ç—Ä–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
      nodeSelector:
        kubernetes.io/os: linux
      tolerations:
      - key: "node.kubernetes.io/not-ready"
        operator: "Exists"
        effect: "NoExecute"
        tolerationSeconds: 300
EOF

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞
kubectl get pods -l app=fast-startup --watch

# –ê–Ω–∞–ª–∏–∑ —Å–æ–±—ã—Ç–∏–π
kubectl get events --field-selector involvedObject.name=$(kubectl get pods -l app=fast-startup -o jsonpath='{.items[0].metadata.name}') --sort-by=.metadata.creationTimestamp

# –û—á–∏—Å—Ç–∫–∞
kubectl delete deployment fast-startup-app
```

### **2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—â–∏–º—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:**
```bash
# –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –º–µ–¥–ª–µ–Ω–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: slow-startup-app
  namespace: default
spec:
  replicas: 2
  selector:
    matchLabels:
      app: slow-startup
  template:
    metadata:
      labels:
        app: slow-startup
    spec:
      initContainers:
      - name: slow-init
        image: busybox
        command: ['sh', '-c', 'echo "Slow initialization..." && sleep 30']
      containers:
      - name: app
        image: nginx:alpine
        imagePullPolicy: Always  # –í—Å–µ–≥–¥–∞ —Å–∫–∞—á–∏–≤–∞—Ç—å
        ports:
        - containerPort: 80
        resources:
          requests:
            cpu: 50m
            memory: 64Mi
          limits:
            cpu: 200m
            memory: 128Mi
        # –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30  # –î–æ–ª–≥–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
          periodSeconds: 10        # –†–µ–¥–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
          timeoutSeconds: 5
          successThreshold: 1
          failureThreshold: 5
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 10
          failureThreshold: 3
EOF

# –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
kubectl get pods -l app=slow-startup --watch

# –û—á–∏—Å—Ç–∫–∞
kubectl delete deployment slow-startup-app
```

### **3. –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–∑–æ–≤ —Å DaemonSet:**
```bash
# –°–æ–∑–¥–∞—Ç—å DaemonSet –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: image-preloader
  namespace: kube-system
spec:
  selector:
    matchLabels:
      app: image-preloader
  template:
    metadata:
      labels:
        app: image-preloader
    spec:
      hostNetwork: true
      initContainers:
      # –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤
      - name: preload-nginx
        image: nginx:alpine
        command: ["echo", "Preloaded nginx:alpine"]
        resources:
          requests:
            cpu: 10m
            memory: 16Mi
          limits:
            cpu: 50m
            memory: 32Mi
      - name: preload-redis
        image: redis:alpine
        command: ["echo", "Preloaded redis:alpine"]
        resources:
          requests:
            cpu: 10m
            memory: 16Mi
          limits:
            cpu: 50m
            memory: 32Mi
      - name: preload-postgres
        image: postgres:13-alpine
        command: ["echo", "Preloaded postgres:13-alpine"]
        resources:
          requests:
            cpu: 10m
            memory: 16Mi
          limits:
            cpu: 50m
            memory: 32Mi
      containers:
      - name: sleep
        image: alpine:latest
        command: ["sleep", "infinity"]
        resources:
          requests:
            cpu: 10m
            memory: 16Mi
          limits:
            cpu: 50m
            memory: 32Mi
      tolerations:
      - operator: Exists
EOF

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏
kubectl get pods -n kube-system -l app=image-preloader

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–±—Ä–∞–∑—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —É–∑–ª—ã
kubectl get nodes -o wide

# –û—á–∏—Å—Ç–∫–∞ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!)
kubectl delete daemonset image-preloader -n kube-system
```

## üîß **–°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç startup-analyzer.sh
cat << 'EOF' > startup-analyzer.sh
#!/bin/bash

echo "üöÄ –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ Pod –≤ HA –∫–ª–∞—Å—Ç–µ—Ä–µ"
echo "==========================================="

POD_NAME="$1"
NAMESPACE="${2:-default}"

if [ -z "$POD_NAME" ]; then
    echo "Usage: $0 <pod-name> [namespace]"
    echo "       $0 all [namespace]  # –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–¥–æ–≤"
    exit 1
fi

analyze_pod() {
    local pod="$1"
    local ns="$2"
    
    echo -e "\nüîç –ê–Ω–∞–ª–∏–∑ Pod: $ns/$pod"
    echo "================================"
    
    # –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    echo "üìä –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:"
    kubectl get pod $pod -n $ns -o custom-columns=NAME:.metadata.name,STATUS:.status.phase,AGE:.metadata.creationTimestamp,NODE:.spec.nodeName
    
    # –°–æ–±—ã—Ç–∏—è –∑–∞–ø—É—Å–∫–∞
    echo -e "\nüìÖ –°–æ–±—ã—Ç–∏—è –∑–∞–ø—É—Å–∫–∞:"
    kubectl get events -n $ns --field-selector involvedObject.name=$pod \
      --sort-by=.metadata.creationTimestamp \
      -o custom-columns=TIME:.metadata.creationTimestamp,REASON:.reason,MESSAGE:.message
    
    # –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –∫–ª—é—á–µ–≤—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
    echo -e "\n‚è±Ô∏è –í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑:"
    local events=$(kubectl get events -n $ns --field-selector involvedObject.name=$pod \
      --sort-by=.metadata.creationTimestamp \
      -o json)
    
    echo "$events" | jq -r '
      .items[] | 
      select(.reason == "Scheduled" or .reason == "Pulling" or .reason == "Pulled" or .reason == "Created" or .reason == "Started") |
      "\(.metadata.creationTimestamp) \(.reason)"
    '
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    echo -e "\nüè• –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:"
    kubectl get pod $pod -n $ns -o yaml | grep -A 10 "readinessProbe\|livenessProbe\|startupProbe" | head -20
    
    # –†–µ—Å—É—Ä—Å—ã
    echo -e "\nüíæ –†–µ—Å—É—Ä—Å—ã:"
    kubectl get pod $pod -n $ns -o jsonpath='{range .spec.containers[*]}{.name}: requests={.resources.requests}, limits={.resources.limits}{"\n"}{end}'
    
    # –û–±—Ä–∞–∑—ã
    echo -e "\nüñºÔ∏è –û–±—Ä–∞–∑—ã:"
    kubectl get pod $pod -n $ns -o jsonpath='{range .spec.containers[*]}{.name}: {.image} (pullPolicy: {.imagePullPolicy}){"\n"}{end}'
}

if [ "$POD_NAME" = "all" ]; then
    echo "üìä –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–¥–æ–≤ –≤ namespace: $NAMESPACE"
    
    # –¢–æ–ø –ø–æ–¥–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞
    echo -e "\nüèÉ –ù–µ–¥–∞–≤–Ω–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø–æ–¥—ã:"
    kubectl get pods -n $NAMESPACE --sort-by=.metadata.creationTimestamp | tail -10
    
    # –ü–æ–¥—ã —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏
    echo -e "\n‚ö†Ô∏è –ü–æ–¥—ã —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏:"
    kubectl get pods -n $NAMESPACE --field-selector=status.phase!=Running
    
    # –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–æ–≤
    echo -e "\nüñºÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã:"
    kubectl get pods -n $NAMESPACE -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}' | sort | uniq -c | sort -nr
    
    # –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    echo -e "\n‚è±Ô∏è –í—Ä–µ–º—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥–æ–≤:"
    kubectl get pods -n $NAMESPACE -o json | jq -r '
      .items[] | 
      select(.status.conditions[]?.type == "Ready" and .status.conditions[]?.status == "True") |
      "\(.metadata.name): Ready since \(.status.conditions[] | select(.type == "Ready").lastTransitionTime)"
    '
else
    analyze_pod "$POD_NAME" "$NAMESPACE"
fi

echo -e "\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò:"
echo "1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–µ–≥–∫–∏–µ –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã (alpine)"
echo "2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ imagePullPolicy: IfNotPresent"
echo "3. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ readinessProbe (–º–µ–Ω—å—à–µ initialDelaySeconds)"
echo "4. –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—Ä–∞–∑—ã"
echo "5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ startupProbe –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
echo "6. –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ initContainers"

echo -e "\n‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω!"
EOF

chmod +x startup-analyzer.sh
```

### **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞:**
```bash
# –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥–∞ ArgoCD
./startup-analyzer.sh argocd-server-xxx argocd

# –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–¥–æ–≤ –≤ namespace –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
./startup-analyzer.sh all monitoring

# –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–¥–æ–≤ –≤ default namespace
./startup-analyzer.sh all
```

## üìä **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Startup Optimization                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Image Optimization                                         ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Multi-stage builds (Reduce image size)                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Layer caching (Faster pulls)                          ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Image preloading (DaemonSet preloader)                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Registry proximity (Local/regional registry)          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Scheduling Optimization                                    ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Resource requests (Guaranteed scheduling)             ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Node affinity (Preferred nodes)                       ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Priority classes (Fast scheduling)                    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Tolerations (Avoid scheduling delays)                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Container Startup                                          ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Minimal init containers (Reduce init time)            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Parallel initialization (Concurrent startup)          ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Lazy loading (Defer heavy operations)                 ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Warm pools (Pre-started containers)                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Health Checks                                              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Fast readiness probes (Quick detection)               ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Startup probes (Slow startup handling)                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Lightweight endpoints (Minimal overhead)              ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Optimized timeouts (Balance speed vs reliability)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üö® **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:**

### **1. Prometheus –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:**
```bash
# –î–æ—Å—Ç—É–ø –∫ Prometheus –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–µ—Ç—Ä–∏–∫
kubectl port-forward svc/prometheus-server -n monitoring 9090:80 &

# –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞:
# –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–æ–≤:
# time() - kube_pod_created

# –í—Ä–µ–º—è –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
# kube_pod_status_ready_time - kube_pod_created

# –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–∑–∞–º–∏:
# kube_pod_container_status_waiting_reason{reason="ImagePullBackOff"}

# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
# kube_pod_container_status_last_terminated_timestamp
```

### **2. –ê–ª–µ—Ä—Ç—ã –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
```bash
# –ü–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–≥–æ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è (>5 –º–∏–Ω—É—Ç)
kubectl get pods --all-namespaces -o json | \
jq -r '.items[] | select(.status.phase == "Pending" and (.metadata.creationTimestamp | fromdateiso8601) < (now - 300)) | "\(.metadata.namespace)/\(.metadata.name): Pending for > 5 minutes"'

# –ü–æ–¥—ã —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤
kubectl get events --all-namespaces --field-selector reason=Failed | grep -i "image"

# –ü–æ–¥—ã —Å –Ω–µ—É–¥–∞—á–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
kubectl get events --all-namespaces --field-selector reason=Unhealthy
```

## üè≠ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤ –≤–∞—à–µ–º HA –∫–ª–∞—Å—Ç–µ—Ä–µ:**

### **1. ArgoCD –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞:**
```bash
# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ ArgoCD
kubectl describe pods -n argocd -l app.kubernetes.io/name=argocd-server | grep -A 15 "Events:"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ ArgoCD
kubectl get pods -n argocd -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}'

# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ ArgoCD
kubectl get pods -n argocd -o yaml | grep -A 10 "readinessProbe"
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–µ–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```bash
# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ Prometheus
kubectl describe pods -n monitoring -l app.kubernetes.io/name=prometheus | grep -A 15 "Events:"

# –û–±—Ä–∞–∑—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
kubectl get pods -n monitoring -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}' | sort | uniq

# –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Grafana
kubectl get pods -n monitoring -l app.kubernetes.io/name=grafana -o yaml | grep -A 10 "readinessProbe"
```

### **3. NGINX Ingress –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```bash
# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ NGINX Ingress
kubectl describe pods -n ingress-nginx -l app.kubernetes.io/name=ingress-nginx | grep -A 15 "Events:"

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NGINX Ingress
kubectl get pods -n ingress-nginx -o yaml | grep -A 10 "readinessProbe"
```

### **4. NFS Provisioner –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```bash
# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ NFS Provisioner
kubectl describe pods -n nfs-provisioner | grep -A 15 "Events:"

# –û–±—Ä–∞–∑—ã NFS –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
kubectl get pods -n nfs-provisioner -o jsonpath='{range .items[*]}{.spec.containers[*].image}{"\n"}{end}'
```

## üéØ **Best Practices –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**

### **1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ alpine –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—É—é —Å–±–æ—Ä–∫—É –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–ª–æ–µ–≤
- –ö—ç—à–∏—Ä—É–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ—è—Ö
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–≥–∏ –≤–º–µ—Å—Ç–æ latest

### **2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ—Å—É—Ä—Å—ã:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ resource requests –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Guaranteed QoS –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ affinity –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ priority classes –¥–ª—è –≤–∞–∂–Ω—ã—Ö –ø–æ–¥–æ–≤

### **3. Health Checks:**
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ initialDelaySeconds –¥–ª—è readinessProbe
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ startupProbe –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—â–∏—Ö—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ health check —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ timeout –∑–Ω–∞—á–µ–Ω–∏—è

### **4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–∑–∞–º–∏
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–Ω–¥—ã –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞

**–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ Pod ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä –¥–ª—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ Kubernetes –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!**

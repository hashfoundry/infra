# 165. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É backup –∏ disaster recovery?

## üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ Backup –∏ Disaster Recovery?**

**Backup –∏ Disaster Recovery (DR)** ‚Äî —ç—Ç–æ –¥–≤–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω–Ω—ã–µ, –Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞. Backup —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–ø–∏–π –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ—Ç–µ—Ä–∏, –∞ DR –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ–π IT-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ—Å–ª–µ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–±–æ–µ–≤ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –ø—Ä–æ—Å—Ç–æ—è.

## üèóÔ∏è **–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É Backup –∏ DR:**

### **1. Scope (–û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è)**
- **Backup**: –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª–æ–≤, –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- **DR**: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ–π IT-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### **2. Objectives (–¶–µ–ª–∏)**
- **Backup**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- **DR**: –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ—è, –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞

### **3. Implementation (–†–µ–∞–ª–∏–∑–∞—Ü–∏—è)**
- **Backup**: Scheduled jobs, storage systems, retention policies
- **DR**: Failover procedures, alternative sites, communication plans

### **4. RTO/RPO**
- **Backup**: RTO: —á–∞—Å—ã/–¥–Ω–∏, RPO: —á–∞—Å—ã
- **DR**: RTO: –º–∏–Ω—É—Ç—ã/—á–∞—Å—ã, RPO: –º–∏–Ω—É—Ç—ã

## üìä **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ HA –∫–ª–∞—Å—Ç–µ—Ä–∞:**

### **1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–∏—Ö Backup –∏ DR –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Backup –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
kubectl get pods -n velero
kubectl get backups -n velero --sort-by=.metadata.creationTimestamp
kubectl get schedules -n velero

# –ü—Ä–æ–≤–µ—Ä–∫–∞ DR –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
kubectl get nodes --show-labels | grep disaster-recovery
kubectl get pods --all-namespaces -l disaster-recovery=enabled

# –ê–Ω–∞–ª–∏–∑ storage –¥–ª—è backup –∏ DR
kubectl get pv -o custom-columns=NAME:.metadata.name,STORAGECLASS:.spec.storageClassName,SIZE:.spec.capacity.storage,STATUS:.status.phase

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º
kubectl get events --field-selector type=Warning | grep -E "(backup|restore|failover)"
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Backup vs DR –º–µ—Ç—Ä–∏–∫:**
```bash
# Backup –º–µ—Ç—Ä–∏–∫–∏
velero backup get -o custom-columns=NAME:.metadata.name,STATUS:.status.phase,CREATED:.metadata.creationTimestamp,SIZE:.status.totalItems

# DR –º–µ—Ç—Ä–∏–∫–∏
kubectl get nodes -o custom-columns=NAME:.metadata.name,STATUS:.status.conditions[-1].type,REGION:.metadata.labels.topology\\.kubernetes\\.io/region

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
kubectl get ingress --all-namespaces -o custom-columns=NAME:.metadata.name,HOSTS:.spec.rules[*].host,ADDRESS:.status.loadBalancer.ingress[*].ip
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Backup –∏ DR –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
```bash
# –¢–µ—Å—Ç backup —Å–∏—Å—Ç–µ–º—ã
velero backup create test-backup-$(date +%s) --include-namespaces default --wait

# –¢–µ—Å—Ç DR –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
kubectl config get-contexts | grep -E "(fra1|ams3)"
kubectl cluster-info --context do-ams3-hashfoundry-dr
```

## üîÑ **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–∏–π Backup vs DR:**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç backup-vs-dr-comparison.sh
cat << 'EOF' > backup-vs-dr-comparison.sh
#!/bin/bash

echo "üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Backup vs Disaster Recovery"
echo "======================================"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
PRIMARY_CLUSTER="hashfoundry-ha"
DR_CLUSTER="hashfoundry-dr"
PRIMARY_REGION="fra1"
DR_REGION="ams3"

# –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

# –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ Backup —Å–∏—Å—Ç–µ–º—ã
analyze_backup_system() {
    log "üíæ –ê–Ω–∞–ª–∏–∑ Backup —Å–∏—Å—Ç–µ–º—ã"
    
    echo "üîç Backup –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Velero
    if kubectl get ns velero >/dev/null 2>&1; then
        echo "‚úÖ Velero —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ backup
        TOTAL_BACKUPS=$(kubectl get backups -n velero --no-headers | wc -l)
        SUCCESSFUL_BACKUPS=$(kubectl get backups -n velero --no-headers | grep Completed | wc -l)
        FAILED_BACKUPS=$(kubectl get backups -n velero --no-headers | grep Failed | wc -l)
        
        echo "  üì¶ –í—Å–µ–≥–æ backup: $TOTAL_BACKUPS"
        echo "  ‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö: $SUCCESSFUL_BACKUPS"
        echo "  ‚ùå –ù–µ—É–¥–∞—á–Ω—ã—Ö: $FAILED_BACKUPS"
        
        # –ü–æ—Å–ª–µ–¥–Ω–∏–π backup
        LATEST_BACKUP=$(kubectl get backups -n velero --sort-by=.metadata.creationTimestamp -o name | tail -1)
        if [ -n "$LATEST_BACKUP" ]; then
            BACKUP_STATUS=$(kubectl get $LATEST_BACKUP -n velero -o jsonpath='{.status.phase}')
            BACKUP_TIME=$(kubectl get $LATEST_BACKUP -n velero -o jsonpath='{.metadata.creationTimestamp}')
            echo "  üïê –ü–æ—Å–ª–µ–¥–Ω–∏–π backup: $BACKUP_TIME ($BACKUP_STATUS)"
        fi
        
        # –†–∞–∑–º–µ—Ä backup storage
        BACKUP_LOCATION=$(velero backup-location get -o json 2>/dev/null | jq -r '.items[0].spec.objectStorage.bucket' 2>/dev/null)
        echo "  üóÑÔ∏è Backup location: $BACKUP_LOCATION"
        
    else
        echo "‚ùå Velero –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ scheduled backup
    echo -e "\nüìÖ Scheduled Backup:"
    kubectl get schedules -n velero -o custom-columns=NAME:.metadata.name,SCHEDULE:.spec.schedule,LAST-BACKUP:.status.lastBackup 2>/dev/null || echo "–ù–µ—Ç scheduled backup"
    
    # Backup —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    echo -e "\nüìã Backup —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:"
    echo "  üéØ –¶–µ–ª—å: –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"
    echo "  üìè –û–±–ª–∞—Å—Ç—å: –§–∞–π–ª—ã, –ë–î, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
    echo "  ‚è∞ –ß–∞—Å—Ç–æ—Ç–∞: –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ)"
    echo "  üîÑ RTO: 1-8 —á–∞—Å–æ–≤"
    echo "  üìä RPO: 1-24 —á–∞—Å–∞"
    echo "  üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è-—Å—Ä–µ–¥–Ω—è—è"
    echo "  üîß –°–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è-—Å—Ä–µ–¥–Ω—è—è"
}

# –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ DR —Å–∏—Å—Ç–µ–º—ã
analyze_dr_system() {
    log "üö® –ê–Ω–∞–ª–∏–∑ Disaster Recovery —Å–∏—Å—Ç–µ–º—ã"
    
    echo "üîç DR –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ DR –∫–ª–∞—Å—Ç–µ—Ä–∞
    if kubectl config get-contexts | grep -q "$DR_CLUSTER"; then
        echo "‚úÖ DR –∫–ª–∞—Å—Ç–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
        
        # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä
        kubectl config use-context do-$DR_REGION-$DR_CLUSTER >/dev/null 2>&1
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ DR –∫–ª–∞—Å—Ç–µ—Ä–∞
        DR_NODES=$(kubectl get nodes --no-headers | wc -l)
        DR_READY_NODES=$(kubectl get nodes --no-headers | grep Ready | wc -l)
        DR_PODS=$(kubectl get pods --all-namespaces --no-headers | wc -l)
        DR_RUNNING_PODS=$(kubectl get pods --all-namespaces --field-selector=status.phase=Running --no-headers | wc -l)
        
        echo "  üèóÔ∏è DR —É–∑–ª–æ–≤: $DR_NODES (–≥–æ—Ç–æ–≤—ã—Ö: $DR_READY_NODES)"
        echo "  üì¶ DR –ø–æ–¥–æ–≤: $DR_PODS (–∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö: $DR_RUNNING_PODS)"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ DR tolerations
        DR_TOLERATIONS=$(kubectl get nodes -o jsonpath='{.items[*].spec.taints[?(@.key=="disaster-recovery")].key}' | wc -w)
        echo "  üè∑Ô∏è DR taints: $DR_TOLERATIONS —É–∑–ª–æ–≤"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ Load Balancer
        DR_LB_IP=$(kubectl get svc -n ingress-nginx ingress-nginx-controller -o jsonpath='{.status.loadBalancer.ingress[0].ip}' 2>/dev/null)
        if [ -n "$DR_LB_IP" ]; then
            echo "  üåê DR Load Balancer: $DR_LB_IP"
        else
            echo "  ‚ö†Ô∏è DR Load Balancer –Ω–µ –≥–æ—Ç–æ–≤"
        fi
        
        # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ primary
        kubectl config use-context do-$PRIMARY_REGION-$PRIMARY_CLUSTER >/dev/null 2>&1
        
    else
        echo "‚ùå DR –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
    fi
    
    # DR —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    echo -e "\nüìã DR —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:"
    echo "  üéØ –¶–µ–ª—å: –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞"
    echo "  üìè –û–±–ª–∞—Å—Ç—å: –í—Å—è IT-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞"
    echo "  ‚è∞ –ß–∞—Å—Ç–æ—Ç–∞: –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é (–ø—Ä–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞—Ö)"
    echo "  üîÑ RTO: 15 –º–∏–Ω—É—Ç - 4 —á–∞—Å–∞"
    echo "  üìä RPO: 5 –º–∏–Ω—É—Ç - 1 —á–∞—Å"
    echo "  üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è-–≤—ã—Å–æ–∫–∞—è"
    echo "  üîß –°–ª–æ–∂–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è"
}

# –§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
compare_recovery_scenarios() {
    log "üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    
    echo "üìã –°—Ü–µ–Ω–∞—Ä–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:"
    echo ""
    echo "1Ô∏è‚É£ –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:"
    echo "   Backup: ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup (1-4 —á–∞—Å–∞)"
    echo "   DR: ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è"
    echo ""
    echo "2Ô∏è‚É£ –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:"
    echo "   Backup: ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏–∑ backup (2-8 —á–∞—Å–æ–≤)"
    echo "   DR: ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ"
    echo ""
    echo "3Ô∏è‚É£ –°–±–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:"
    echo "   Backup: ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (1-6 —á–∞—Å–æ–≤)"
    echo "   DR: ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä (15-60 –º–∏–Ω—É—Ç)"
    echo ""
    echo "4Ô∏è‚É£ –û—Ç–∫–∞–∑ —É–∑–ª–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞:"
    echo "   Backup: ‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è"
    echo "   DR: ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (5-30 –º–∏–Ω—É—Ç)"
    echo ""
    echo "5Ô∏è‚É£ –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞:"
    echo "   Backup: ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (4-24 —á–∞—Å–∞)"
    echo "   DR: ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (15 –º–∏–Ω—É—Ç - 4 —á–∞—Å–∞)"
    echo ""
    echo "6Ô∏è‚É£ –ö–∏–±–µ—Ä–∞—Ç–∞–∫–∞/ransomware:"
    echo "   Backup: ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∏—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö (2-12 —á–∞—Å–æ–≤)"
    echo "   DR: ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (30 –º–∏–Ω—É—Ç - 2 —á–∞—Å–∞)"
}

# –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
analyze_integration() {
    log "üîó –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Backup –∏ DR"
    
    echo "ü§ù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º:"
    echo ""
    echo "‚úÖ Backup –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DR:"
    echo "   ‚Ä¢ Backup –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –≤ DR —Ä–µ–≥–∏–æ–Ω"
    echo "   ‚Ä¢ DR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç backup –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    echo "   ‚Ä¢ –û–±—â–∏–µ storage backend (Digital Ocean Spaces)"
    echo ""
    echo "‚úÖ DR –¥–æ–ø–æ–ª–Ω—è–µ—Ç Backup:"
    echo "   ‚Ä¢ DR –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"
    echo "   ‚Ä¢ Backup –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ"
    echo "   ‚Ä¢ –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä"
    echo ""
    echo "üìä –°–æ–≤–º–µ—Å—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    SHARED_STORAGE=$(kubectl get pv | grep -c "do-block-storage")
    MONITORING_PODS=$(kubectl get pods -n monitoring --no-headers | wc -l)
    
    echo "   ‚Ä¢ –û–±—â–∏—Ö storage volumes: $SHARED_STORAGE"
    echo "   ‚Ä¢ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–≤: $MONITORING_PODS"
    echo "   ‚Ä¢ –û–±—â–∏–π Prometheus –¥–ª—è –º–µ—Ç—Ä–∏–∫"
    echo "   ‚Ä¢ –û–±—â–∏–π Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏"
}

# –§—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
provide_recommendations() {
    log "üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é"
    
    echo "üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Backup:"
    echo "   ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"
    echo "   ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤"
    echo "   ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
    echo "   ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∞–º —Ö—Ä–∞–Ω–µ–Ω–∏—è"
    echo "   ‚úÖ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ"
    echo ""
    echo "üö® –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DR:"
    echo "   ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
    echo "   ‚úÖ –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏"
    echo "   ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ RTO/RPO"
    echo "   ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ"
    echo "   ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SLA"
    echo ""
    echo "ü§ù –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:"
    echo "   ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞"
    echo "   ‚úÖ –†–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    echo "   ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç"
    echo "   ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è"
    echo ""
    echo "üí∞ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç:"
    echo "   ‚Ä¢ Backup: –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö"
    echo "   ‚Ä¢ DR: –¢–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤"
    echo "   ‚Ä¢ Tier-based –ø–æ–¥—Ö–æ–¥ –∫ –∑–∞—â–∏—Ç–µ"
    echo "   ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤"
}

# –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞
generate_report() {
    log "üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
    
    REPORT_FILE="/tmp/backup-vs-dr-report-$(date +%Y%m%d-%H%M%S).txt"
    
    {
        echo "BACKUP VS DISASTER RECOVERY COMPARISON REPORT"
        echo "============================================="
        echo "Generated: $(date)"
        echo "Cluster: $PRIMARY_CLUSTER"
        echo ""
        
        # Backup —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        echo "BACKUP SYSTEM STATUS:"
        kubectl get backups -n velero --no-headers 2>/dev/null | \
            awk '{print $2}' | sort | uniq -c || echo "No backup data"
        echo ""
        
        # DR —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        echo "DR SYSTEM STATUS:"
        kubectl config get-contexts | grep -E "(fra1|ams3)" || echo "No DR contexts"
        echo ""
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        echo "RECOMMENDATIONS:"
        echo "1. Implement both backup and DR for comprehensive protection"
        echo "2. Use backup for daily data protection"
        echo "3. Use DR for business continuity"
        echo "4. Regular testing of both systems"
        echo "5. Document all procedures"
        
    } > "$REPORT_FILE"
    
    echo "üìÑ –û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: $REPORT_FILE"
}

# –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
main() {
    log "üöÄ –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Backup vs DR"
    
    analyze_backup_system
    echo ""
    analyze_dr_system
    echo ""
    compare_recovery_scenarios
    echo ""
    analyze_integration
    echo ""
    provide_recommendations
    echo ""
    generate_report
    
    log "üéâ –°–†–ê–í–ù–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!"
    log "üìã –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:"
    log "  ‚Ä¢ Backup –∏ DR —Ä–µ—à–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏"
    log "  ‚Ä¢ Backup: –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö, DR: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞"
    log "  ‚Ä¢ –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∑–∞—â–∏—Ç—É"
    log "  ‚Ä¢ –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π RTO/RPO"
}

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
trap 'log "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏"; exit 1' ERR

# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
main "$@"
EOF

chmod +x backup-vs-dr-comparison.sh
```

### **2. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç scenario-testing.sh
cat << 'EOF' > scenario-testing.sh
#!/bin/bash

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ Backup vs DR"
echo "===================================="

# –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

# –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ (Backup —Ä–µ—à–µ–Ω–∏–µ)
test_file_deletion_scenario() {
    log "üìÅ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è: –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞"
    
    echo "üéØ –°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª–∏–ª –≤–∞–∂–Ω—ã–π ConfigMap"
    echo "üí° –†–µ—à–µ–Ω–∏–µ: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup"
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ ConfigMap
    kubectl apply -f - << CONFIG_EOF
apiVersion: v1
kind: ConfigMap
metadata:
  name: important-config
  namespace: default
  labels:
    backup-test: "true"
data:
  config.yaml: |
    app:
      name: "Important Application"
      version: "1.0.0"
      database:
        host: "db.example.com"
        port: "5432"
CONFIG_EOF
    
    echo "‚úÖ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π ConfigMap"
    
    # –°–æ–∑–¥–∞–Ω–∏–µ backup
    velero backup create file-deletion-test-$(date +%s) \
        --include-namespaces default \
        --selector backup-test=true \
        --wait
    
    echo "‚úÖ Backup —Å–æ–∑–¥–∞–Ω"
    
    # –°–∏–º—É–ª—è—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è
    kubectl delete configmap important-config
    echo "‚ùå ConfigMap —É–¥–∞–ª–µ–Ω (—Å–∏–º—É–ª—è—Ü–∏—è –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)"
    
    # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
    BACKUP_NAME=$(velero backup get -o name | grep file-deletion-test | head -1)
    velero restore create file-deletion-restore-$(date +%s) \
        --from-backup ${BACKUP_NAME##*/} \
        --wait
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
    if kubectl get configmap important-config >/dev/null 2>&1; then
        echo "‚úÖ ConfigMap –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–∑ backup"
        echo "‚è∞ –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: ~2-5 –º–∏–Ω—É—Ç"
        echo "üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è (—Ç–æ–ª—å–∫–æ backup storage)"
    else
        echo "‚ùå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å"
    fi
    
    # –û—á–∏—Å—Ç–∫–∞
    kubectl delete configmap important-config --ignore-not-found
    velero backup delete ${BACKUP_NAME##*/} --confirm >/dev/null 2>&1
}

# –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û—Ç–∫–∞–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞ (DR —Ä–µ—à–µ–Ω–∏–µ)
test_cluster_failure_scenario() {
    log "üèóÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è: –û—Ç–∫–∞–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞"
    
    echo "üéØ –°—Ü–µ–Ω–∞—Ä–∏–π: Primary –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    echo "üí° –†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ primary –∫–ª–∞—Å—Ç–µ—Ä–∞
    if kubectl cluster-info >/dev/null 2>&1; then
        echo "‚úÖ Primary –∫–ª–∞—Å—Ç–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        kubectl apply -f - << APP_EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-app
  namespace: default
spec:
  replicas: 2
  selector:
    matchLabels:
      app: test-app
  template:
    metadata:
      labels:
        app: test-app
    spec:
      containers:
      - name: app
        image: nginx:alpine
        ports:
        - containerPort: 80
        resources:
          requests:
            cpu: 50m
            memory: 64Mi
---
apiVersion: v1
kind: Service
metadata:
  name: test-app
  namespace: default
spec:
  selector:
    app: test-app
  ports:
  - port: 80
    targetPort: 80
  type: ClusterIP
APP_EOF
        
        echo "‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –≤ primary –∫–ª–∞—Å—Ç–µ—Ä–µ"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ backup –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        velero backup create cluster-failure-test-$(date +%s) \
            --include-namespaces default \
            --selector app=test-app \
            --wait
        
        echo "‚úÖ Backup –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω"
        
        # –°–∏–º—É–ª—è—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä
        if kubectl config get-contexts | grep -q "hashfoundry-dr"; then
            echo "üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä..."
            kubectl config use-context do-ams3-hashfoundry-dr
            
            # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ DR –∫–ª–∞—Å—Ç–µ—Ä–µ
            BACKUP_NAME=$(velero backup get -o name | grep cluster-failure-test | head -1)
            velero restore create cluster-failure-restore-$(date +%s) \
                --from-backup ${BACKUP_NAME##*/} \
                --wait
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
            if kubectl get deployment test-app >/dev/null 2>&1; then
                echo "‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ DR –∫–ª–∞—Å—Ç–µ—Ä–µ"
                echo "‚è∞ –í—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è: ~5-15 –º–∏–Ω—É—Ç"
                echo "üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)"
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
                kubectl wait --for=condition=available deployment/test-app --timeout=300s
                echo "‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ"
            else
                echo "‚ùå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ DR –∫–ª–∞—Å—Ç–µ—Ä–µ –Ω–µ —É–¥–∞–ª–æ—Å—å"
            fi
            
            # –í–æ–∑–≤—Ä–∞—Ç –∫ primary –∫–ª–∞—Å—Ç–µ—Ä—É
            kubectl config use-context do-fra1-hashfoundry-ha
            echo "üîÑ –í–æ–∑–≤—Ä–∞—Ç –∫ primary –∫–ª–∞—Å—Ç–µ—Ä—É"
        else
            echo "‚ö†Ô∏è DR –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
        fi
        
        # –û—á–∏—Å—Ç–∫–∞
        kubectl delete deployment test-app --ignore-not-found
        kubectl delete service test-app --ignore-not-found
    else
        echo "‚ùå Primary –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    fi
}

# –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Backup —Ä–µ—à–µ–Ω–∏–µ)
test_data_corruption_scenario() {
    log "üíæ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è: –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö"
    
    echo "üéØ –°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
    echo "üí° –†–µ—à–µ–Ω–∏–µ: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup"
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π "–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" (ConfigMap —Å –¥–∞–Ω–Ω—ã–º–∏)
    kubectl apply -f - << DB_EOF
apiVersion: v1
kind: ConfigMap
metadata:
  name: test-database
  namespace: default
  labels:
    component: database
data:
  users.json: |
    {
      "users": [
        {"id": 1, "name": "Alice", "email": "alice@example.com"},
        {"id": 2, "name": "Bob", "email": "bob@example.com"},
        {"id": 3, "name": "Charlie", "email": "charlie@example.com"}
      ]
    }
  products.json: |
    {
      "products": [
        {"id": 1, "name": "Product A", "price": 100},
        {"id": 2, "name": "Product B", "price": 200}
      ]
    }
DB_EOF
    
    echo "‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞"
    
    # –°–æ–∑–¥–∞–Ω–∏–µ backup
    velero backup create data-corruption-test-$(date +%s) \
        --include-namespaces default \
        --selector component=database \
        --wait
    
    echo "‚úÖ Backup –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω"
    
    # –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    kubectl patch configmap test-database --patch='{"data":{"users.json":"CORRUPTED DATA","products.json":"CORRUPTED DATA"}}'
    echo "‚ùå –î–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã (—Å–∏–º—É–ª—è—Ü–∏—è corruption)"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è
    CORRUPTED_DATA=$(kubectl get configmap test-database -o jsonpath='{.data.users\.json}')
    if [[ "$CORRUPTED_DATA" == "CORRUPTED DATA" ]]; then
        echo "‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö"
        
        # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
        kubectl delete configmap test-database
        
        BACKUP_NAME=$(velero backup get -o name | grep data-corruption-test | head -1)
        velero restore create data-corruption-restore-$(date +%s) \
            --from-backup ${BACKUP_NAME##*/} \
            --wait
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
        RESTORED_DATA=$(kubectl get configmap test-database -o jsonpath='{.data.users\.json}' 2>/dev/null)
        if [[ "$RESTORED_DATA" == *"Alice"* ]]; then
            echo "‚úÖ –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ backup"
            echo "‚è∞ –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: ~3-10 –º–∏–Ω—É—Ç"
            echo "üìä RPO: –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ backup"
        else
            echo "‚ùå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É–¥–∞–ª–æ—Å—å"
        fi
    fi
    
    # –û—á–∏—Å—Ç–∫–∞
    kubectl delete configmap test-database --ignore-not-found
}

# –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
test_performance_comparison() {
    log "‚ö° –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Backup vs DR"
    
    echo "üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:"
    
    # –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ backup
    echo "üíæ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ backup..."
    START_TIME=$(date +%s)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    for i in {1..10}; do
        kubectl create configmap test-data-$i --from-literal=data="Test data for backup performance test $i"
    done
    
    # –°–æ–∑–¥–∞–Ω–∏–µ backup
    velero backup create performance-test-$(date +%s) \
        --include-namespaces default \
        --selector app.kubernetes.io/name=test-data \
        --wait >/dev/null 2>&1
    
    BACKUP_END_TIME=$(date +%s)
    BACKUP_DURATION=$((BACKUP_END_TIME - START_TIME))
    
    echo "‚úÖ Backup –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ $BACKUP_DURATION —Å–µ–∫—É–Ω–¥"
    
    # –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ restore
    echo "üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ restore..."
    
    # –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    for i in {1..10}; do
        kubectl delete configmap test-data-$i --ignore-not-found
    done
    
    RESTORE_START_TIME=$(date +%s)
    
    # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
    BACKUP_NAME=$(velero backup get -o name | grep performance-test | head -1)
    velero restore create performance-restore-$(date +%s) \
        --from-backup ${BACKUP_NAME##*/} \
        --wait >/dev/null 2>&1
    
    RESTORE_END_TIME=$(date +%s)
    RESTORE_DURATION=$((RESTORE_END_TIME - RESTORE_START_TIME))
    
    echo "‚úÖ Restore –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ $RESTORE_DURATION —Å–µ–∫—É–Ω–¥"
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å DR (—Å–∏–º—É–ª—è—Ü–∏—è)
    echo "üö® –°–∏–º—É–ª—è—Ü–∏—è DR –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è..."
    DR_START_TIME=$(date +%s)
    
    # –°–∏–º—É–ª—è—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è DNS –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
    sleep 5  # –°–∏–º—É–ª—è—Ü–∏—è DNS propagation
    sleep 10 # –°–∏–º—É–ª—è—Ü–∏—è service startup
    
    DR_END_TIME=$(date +%s)
    DR_DURATION=$((DR_END_TIME - DR_START_TIME))
    
    echo "‚úÖ DR –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ $DR_DURATION —Å–µ–∫—É–Ω–¥"
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    echo ""
    echo "üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–†–ê–í–ù–ï–ù–ò–Ø:"
    echo "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
    echo "‚îÇ –û–ø–µ—Ä–∞—Ü–∏—è        ‚îÇ –í—Ä–µ–º—è (—Å–µ–∫)  ‚îÇ –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å ‚îÇ"
    echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
    echo "‚îÇ Backup          ‚îÇ $BACKUP_DURATION         ‚îÇ –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö‚îÇ"
    echo "‚îÇ Restore         ‚îÇ $RESTORE_DURATION        ‚îÇ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ‚îÇ"
    echo "‚îÇ DR Failover     ‚îÇ $DR_DURATION         ‚îÇ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å‚îÇ"
    echo "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
    
    # –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    for i in {1..10}; do
        kubectl delete configmap test-data-$i --ignore-not-found
    done
}

# –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
main() {
    case "$1" in
        file-deletion)
            test_file_deletion_scenario
            ;;
        cluster-failure)
            test_cluster_failure_scenario
            ;;
        data-corruption)
            test_data_corruption_scenario
            ;;
        performance)
            test_performance_comparison
            ;;
        all)
            log "üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"
            test_file_deletion_scenario
            echo ""
            test_cluster_failure_scenario
            echo ""
            test_data_corruption_scenario
            echo ""
            test_performance_comparison
            ;;
        *)
            echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 {file-deletion|cluster-failure|data-corruption|performance|all}"
            echo "  file-deletion   - –¢–µ—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"
            echo "  cluster-failure - –¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ DR –∫–ª–∞—Å—Ç–µ—Ä"
            echo "  data-corruption - –¢–µ—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"
            echo "  performance     - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
            echo "  all            - –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤"
            exit 1
            ;;
    esac
}

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
trap 'log "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"; exit 1' ERR

# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
main "$@"
EOF

chmod +x scenario-testing.sh
```

## üìä **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Backup –∏ DR:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            Integrated Backup & DR Architecture             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Data Protection Layers                                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ    BACKUP LAYER     ‚îÇ    ‚îÇ      DR LAYER       ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ                     ‚îÇ    ‚îÇ                     ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  üì¶ Daily Backups   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  üö® Hot Standby     ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  üìÖ Scheduled Jobs  ‚îÇ    ‚îÇ  üîÑ Auto Failover   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  üóÑÔ∏è Long-term Store ‚îÇ    ‚îÇ  üåê DNS Switching   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  üîç Point-in-time   ‚îÇ    ‚îÇ  ‚ö° Fast Recovery    ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ           ‚îÇ                              ‚îÇ                  ‚îÇ
‚îÇ           ‚ñº                              ‚ñº                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ              Shared Components                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  üóÑÔ∏è Digital Ocean Spaces (Backup Storage)              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  üìä Prometheus (Monitoring)                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  üìà Grafana (Visualization)                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  üîî AlertManager (Notifications)                        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Recovery Scenarios Matrix                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Scenario            ‚îÇ Best Solution‚îÇ RTO/RPO            ‚îÇ ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ
‚îÇ  ‚îÇ File Deletion       ‚îÇ Backup      ‚îÇ 1-4h / 24h         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Data Corruption     ‚îÇ Backup      ‚îÇ 2-8h / 4h          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ App Failure         ‚îÇ Both        ‚îÇ 15m-6h / 1-4h      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Node Failure        ‚îÇ DR          ‚îÇ 5-30m / 5m         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Site Disaster       ‚îÇ DR          ‚îÇ 15m-4h / 5m-1h     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Cyber Attack        ‚îÇ Both        ‚îÇ 30m-12h / 1-4h     ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üéØ **–ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:**

### **1. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Backup:**
| –°—Ü–µ–Ω–∞—Ä–∏–π | Backup –ø–æ–¥—Ö–æ–¥–∏—Ç | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|----------------|---------|
| –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –¢–æ—á–µ—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ |
| –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –û—Ç–∫–∞—Ç –∫ —á–∏—Å—Ç–æ–π –≤–µ—Ä—Å–∏–∏ |
| –û—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ |
| –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∞–º | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ |
| –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è |

### **2. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DR:**
| –°—Ü–µ–Ω–∞—Ä–∏–π | DR –ø–æ–¥—Ö–æ–¥–∏—Ç | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|-------------|---------|
| –û—Ç–∫–∞–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ |
| –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ |
| –í—ã—Å–æ–∫–∏–µ SLA | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π RTO |
| –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞ |
| –ö–∏–±–µ—Ä–∞—Ç–∞–∫–∏ | ‚úÖ –•–æ—Ä–æ—à–æ | –ò–∑–æ–ª—è—Ü–∏—è –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ |

### **3. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç integration-monitoring.sh
cat << 'EOF' > integration-monitoring.sh
#!/bin/bash

echo "üîó –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Backup –∏ DR"
echo "=================================="

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
check_shared_components() {
    echo "ü§ù –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:"
    
    # –û–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    SHARED_STORAGE=$(kubectl get pv | grep -c "do-block-storage")
    echo "  üóÑÔ∏è –û–±—â–∏—Ö storage volumes: $SHARED_STORAGE"
    
    # –û–±—â–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    PROMETHEUS_PODS=$(kubectl get pods -n monitoring -l app.kubernetes.io/name=prometheus --no-headers | wc -l)
    GRAFANA_PODS=$(kubectl get pods -n monitoring -l app.kubernetes.io/name=grafana --no-headers | wc -l)
    echo "  üìä Prometheus pods: $PROMETHEUS_PODS"
    echo "  üìà Grafana pods: $GRAFANA_PODS"
    
    # –û–±—â–∏–µ –∞–ª–µ—Ä—Ç—ã
    BACKUP_ALERTS=$(kubectl get prometheusrules -n monitoring -o yaml | grep -c "backup\|velero" || echo "0")
    DR_ALERTS=$(kubectl get prometheusrules -n monitoring -o yaml | grep -c "disaster\|failover" || echo "0")
    echo "  üîî Backup alerts: $BACKUP_ALERTS"
    echo "  üö® DR alerts: $DR_ALERTS"
}

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
check_synchronization() {
    echo -e "\nüîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:"
    
    # –ü–æ—Å–ª–µ–¥–Ω–∏–π backup
    LATEST_BACKUP=$(velero backup get --sort-by=.metadata.creationTimestamp -o name | tail -1)
    if [ -n "$LATEST_BACKUP" ]; then
        BACKUP_TIME=$(kubectl get $LATEST_BACKUP -n velero -o jsonpath='{.metadata.creationTimestamp}')
        BACKUP_AGE=$(( $(date +%s) - $(date -d "$BACKUP_TIME" +%s) ))
        echo "  üì¶ –ü–æ—Å–ª–µ–¥–Ω–∏–π backup: $((BACKUP_AGE / 60)) –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥"
        
        if [ $BACKUP_AGE -lt 3600 ]; then
            echo "  ‚úÖ Backup –∞–∫—Ç—É–∞–ª–µ–Ω"
        else
            echo "  ‚ö†Ô∏è Backup —É—Å—Ç–∞—Ä–µ–ª"
        fi
    fi
    
    # –°–æ—Å—Ç–æ—è–Ω–∏–µ DR –∫–ª–∞—Å—Ç–µ—Ä–∞
    if kubectl config get-contexts | grep -q "hashfoundry-dr"; then
        kubectl config use-context do-ams3-hashfoundry-dr >/dev/null 2>&1
        DR_NODES=$(kubectl get nodes --no-headers | grep Ready | wc -l)
        echo "  üèóÔ∏è DR —É–∑–ª–æ–≤ –≥–æ—Ç–æ–≤–æ: $DR_NODES"
        kubectl config use-context do-fra1-hashfoundry-ha >/dev/null 2>&1
    fi
}

# –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∫—Ä—ã—Ç–∏—è
analyze_coverage() {
    echo -e "\nüìã –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è –∑–∞—â–∏—Ç—ã:"
    
    # Namespace —Å backup
    BACKUP_NAMESPACES=$(kubectl get schedules -n velero -o yaml | grep -o "includedNamespaces:.*" | wc -l)
    echo "  üì¶ Namespace —Å backup: $BACKUP_NAMESPACES"
    
    # –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    CRITICAL_APPS=$(kubectl get deployments --all-namespaces -l tier=critical --no-headers | wc -l)
    echo "  üéØ –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π: $CRITICAL_APPS"
    
    # –ü–æ–∫—Ä—ã—Ç–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
    MONITORED_SERVICES=$(kubectl get servicemonitors --all-namespaces --no-headers | wc -l)
    echo "  üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤: $MONITORED_SERVICES"
}

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
main() {
    echo "üöÄ –ó–ê–ü–£–°–ö –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ò"
    echo "==============================="
    
    check_shared_components
    check_synchronization
    analyze_coverage
    
    echo -e "\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:"
    echo "1. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é backup –∏ DR"
    echo "2. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–∞ —Ä–µ—à–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ"
    echo "3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã"
    echo "4. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–æ–≤"
    
    echo -e "\n‚úÖ –ú–û–ù–ò–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–ï–ù!"
}

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
main
EOF

chmod +x integration-monitoring.sh
```

## üéØ **Best Practices –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Backup –∏ DR:**

### **1. –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ RTO/RPO –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏
- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ tier
- –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –±—é–¥–∂–µ—Ç –Ω–∞ –æ–±–µ —Å–∏—Å—Ç–µ–º—ã

### **2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—â–∏–µ storage backend
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã backup –∏ DR
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ cross-region —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é

### **3. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã**
- –°–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ runbooks
- –û–±—É—á–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –æ–±–µ–∏–º —Å–∏—Å—Ç–µ–º–∞–º
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### **4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ª—É—á—à–µ–Ω–∏–µ**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

**–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É Backup –∏ Disaster Recovery –∏ –∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∑–∞—â–∏—Ç—É –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞ –≤ Kubernetes —Å—Ä–µ–¥–µ!**

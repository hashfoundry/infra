# Pod Disruption Budget (PDB) - –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ Pod Disruption Budget (PDB)?**

Pod Disruption Budget - —ç—Ç–æ Kubernetes —Ä–µ—Å—É—Ä—Å, –∫–æ—Ç–æ—Ä—ã–π **–∑–∞—â–∏—â–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–æ–≤** –≤–æ –≤—Ä–µ–º—è –ø–ª–∞–Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

## üö® **–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ PDB**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞**
```bash
# Kubernetes —Ä–µ—à–∞–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —É–∑–µ–ª
kubectl drain node-1 --force

# –ë–ï–ó PDB: –í—Å–µ –ø–æ–¥—ã —Å —É–∑–ª–∞ —É–¥–∞–ª—è—é—Ç—Å—è –û–î–ù–û–í–†–ï–ú–ï–ù–ù–û
NGINX Ingress: 3 –ø–æ–¥–∞ ‚Üí 0 –ø–æ–¥–æ–≤ (–µ—Å–ª–∏ –≤—Å–µ –±—ã–ª–∏ –Ω–∞ node-1)
React App: 3 –ø–æ–¥–∞ ‚Üí 0 –ø–æ–¥–æ–≤ (–µ—Å–ª–∏ –≤—Å–µ –±—ã–ª–∏ –Ω–∞ node-1)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–û–õ–ù–ê–Ø –ù–ï–î–û–°–¢–£–ü–ù–û–°–¢–¨ –°–ï–†–í–ò–°–ê! ‚ùå
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Helm chart
helm upgrade nginx-ingress ./nginx-ingress

# –ë–ï–ó PDB: Rolling update –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–æ–¥—ã —Å—Ä–∞–∑—É
NGINX Ingress: 3 –ø–æ–¥–∞ ‚Üí 0 –ø–æ–¥–æ–≤ ‚Üí 3 –Ω–æ–≤—ã—Ö –ø–æ–¥–∞

# –†–µ–∑—É–ª—å—Ç–∞—Ç: DOWNTIME –Ω–∞ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–¥–æ–≤! ‚ùå
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ –∫–ª–∞—Å—Ç–µ—Ä–∞**
```bash
# –ö–ª–∞—Å—Ç–µ—Ä —Ä–µ—à–∞–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤
Cluster Autoscaler: –£–¥–∞–ª—è–µ—Ç —É–∑–µ–ª —Å –ø–æ–¥–∞–º–∏

# –ë–ï–ó PDB: –í—Å–µ –ø–æ–¥—ã —Å —É–∑–ª–∞ —É–¥–∞–ª—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –í–æ–∑–º–æ–∂–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞! ‚ùå
```

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ —Å PDB**

### **–ù–∞—à PDB –¥–ª—è NGINX Ingress:**
```yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: nginx-ingress-controller-pdb
spec:
  minAvailable: 2  # –ú–ò–ù–ò–ú–£–ú 2 –ø–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –í–°–ï–ì–î–ê —Ä–∞–±–æ—Ç–∞—Ç—å
  selector:
    matchLabels:
      app.kubernetes.io/name: ingress-nginx
      app.kubernetes.io/component: controller
```

### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

#### **–°—Ü–µ–Ω–∞—Ä–∏–π 1 –° PDB: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤**
```bash
kubectl drain node-1

# Kubernetes –ø—Ä–æ–≤–µ—Ä—è–µ—Ç PDB:
# - –í—Å–µ–≥–æ NGINX –ø–æ–¥–æ–≤: 3
# - –ù–∞ node-1: 1 –ø–æ–¥
# - –û—Å—Ç–∞–Ω–µ—Ç—Å—è –ø–æ—Å–ª–µ drain: 2 –ø–æ–¥–∞
# - PDB —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º: 2 –ø–æ–¥–∞
# ‚úÖ –†–ê–ó–†–ï–®–ï–ù–û: drain –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

# –ï—Å–ª–∏ –±—ã –Ω–∞ node-1 –±—ã–ª–æ 2 –ø–æ–¥–∞:
# - –û—Å—Ç–∞–Ω–µ—Ç—Å—è –ø–æ—Å–ª–µ drain: 1 –ø–æ–¥  
# - PDB —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º: 2 –ø–æ–¥–∞
# ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û: drain –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∞
```

#### **–°—Ü–µ–Ω–∞—Ä–∏–π 2 –° PDB: Rolling Update**
```bash
helm upgrade nginx-ingress ./nginx-ingress

# Rolling Update —Å PDB:
# –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å 1 –Ω–æ–≤—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 4)
# –®–∞–≥ 2: –£–¥–∞–ª–∏—Ç—å 1 —Å—Ç–∞—Ä—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 3, –º–∏–Ω–∏–º—É–º 2 ‚úÖ)
# –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å 1 –Ω–æ–≤—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 4)  
# –®–∞–≥ 4: –£–¥–∞–ª–∏—Ç—å 1 —Å—Ç–∞—Ä—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 3, –º–∏–Ω–∏–º—É–º 2 ‚úÖ)
# –®–∞–≥ 5: –°–æ–∑–¥–∞—Ç—å 1 –Ω–æ–≤—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 4)
# –®–∞–≥ 6: –£–¥–∞–ª–∏—Ç—å 1 —Å—Ç–∞—Ä—ã–π –ø–æ–¥ (–≤—Å–µ–≥–æ 3, –º–∏–Ω–∏–º—É–º 2 ‚úÖ)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: ZERO DOWNTIME! ‚úÖ
```

## üìä **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã**

### **–ü—Ä–∏–º–µ—Ä 1: NGINX Ingress (3 replicas)**
```yaml
# PDB –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
minAvailable: 2

# –°—Ü–µ–Ω–∞—Ä–∏–∏:
‚úÖ –£–¥–∞–ª–∏—Ç—å 1 –ø–æ–¥: 3 ‚Üí 2 (‚â• 2) - –†–ê–ó–†–ï–®–ï–ù–û
‚ùå –£–¥–∞–ª–∏—Ç—å 2 –ø–æ–¥–∞: 3 ‚Üí 1 (< 2) - –ó–ê–ü–†–ï–©–ï–ù–û  
‚ùå –£–¥–∞–ª–∏—Ç—å 3 –ø–æ–¥–∞: 3 ‚Üí 0 (< 2) - –ó–ê–ü–†–ï–©–ï–ù–û
```

### **–ü—Ä–∏–º–µ—Ä 2: React App (3 replicas)**
```yaml
# PDB –Ω–∞—Å—Ç—Ä–æ–π–∫–∞  
minAvailable: 2

# –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
‚úÖ Scale down: 5 ‚Üí 3 ‚Üí 2 (–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ 2)
‚ùå Scale down: 3 ‚Üí 1 - –ó–ê–ü–†–ï–©–ï–ù–û PDB
```

### **–ü—Ä–∏–º–µ—Ä 3: –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞**
```bash
# –ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ 3-—É–∑–ª–æ–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
# –£–∑–ª—ã: node-1, node-2, node-3
# NGINX –ø–æ–¥—ã: –ø–æ 1 –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ

# –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ node-1:
kubectl drain node-1
# ‚úÖ –†–ê–ó–†–ï–®–ï–ù–û: –æ—Å—Ç–∞–Ω–µ—Ç—Å—è 2 –ø–æ–¥–∞ (node-2, node-3)

# –ü–æ–ø—ã—Ç–∫–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è node-2 —Å—Ä–∞–∑—É:
kubectl drain node-2  
# ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û: –æ—Å—Ç–∞–Ω–µ—Ç—Å—è 1 –ø–æ–¥ (< 2 –º–∏–Ω–∏–º—É–º)

# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
# 1. –î–æ–∂–¥–∞—Ç—å—Å—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∞ –Ω–∞ node-1
# 2. –¢–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å node-2
```

## üîß **–¢–∏–ø—ã PDB –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**

### **1. minAvailable (–º–∏–Ω–∏–º—É–º –¥–æ—Å—Ç—É–ø–Ω—ã—Ö)**
```yaml
spec:
  minAvailable: 2        # –ú–∏–Ω–∏–º—É–º 2 –ø–æ–¥–∞
  # –∏–ª–∏
  minAvailable: "50%"    # –ú–∏–Ω–∏–º—É–º 50% –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
```

### **2. maxUnavailable (–º–∞–∫—Å–∏–º—É–º –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö)**
```yaml
spec:
  maxUnavailable: 1      # –ú–∞–∫—Å–∏–º—É–º 1 –ø–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  # –∏–ª–∏  
  maxUnavailable: "25%"  # –ú–∞–∫—Å–∏–º—É–º 25% –ø–æ–¥–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
```

## üéØ **–ù–∞—à–∏ PDB –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

### **NGINX Ingress Controller:**
```yaml
# 3 replicas, minAvailable: 2
# –û–∑–Ω–∞—á–∞–µ—Ç: –í–°–ï–ì–î–ê –º–∏–Ω–∏–º—É–º 2 –ø–æ–¥–∞ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å
# –ú–∞–∫—Å–∏–º—É–º 1 –ø–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
```

### **React App:**
```yaml
# 3 replicas, minAvailable: 2  
# –û–∑–Ω–∞—á–∞–µ—Ç: –í–°–ï–ì–î–ê –º–∏–Ω–∏–º—É–º 2 –ø–æ–¥–∞ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å
# –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ –Ω–µ –º–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –Ω–∏–∂–µ 2 –ø–æ–¥–æ–≤
```

## üöÄ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PDB**

### **üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç downtime:**
- **–ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ**: –£–∑–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
- **Rolling updates**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è
- **–ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥**: –ó–∞—â–∏—Ç–∞ –æ—Ç —á—Ä–µ–∑–º–µ—Ä–Ω–æ–≥–æ —É–º–µ–Ω—å—à–µ–Ω–∏—è

### **‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- **Kubernetes —Å–∞–º** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç PDB –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –æ–ø–∞—Å–Ω—ã–µ** –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ** –∫–æ–Ω—Ç—Ä–æ–ª—è

### **üìà –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- **–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏**
- **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç SLA** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üîç **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PDB**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ PDB
kubectl get pdb -A

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
kubectl describe pdb nginx-ingress-controller-pdb -n ingress-nginx

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
# Name:           nginx-ingress-controller-pdb
# Min available:  2
# Max unavailable: N/A
# Allowed disruptions: 1  # –°–∫–æ–ª—å–∫–æ –ø–æ–¥–æ–≤ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
# Current:        3       # –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–æ–≤
# Desired:        3       # –ñ–µ–ª–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
# Total:          3       # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
```

### **–ê–ª–µ—Ä—Ç—ã –Ω–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ PDB:**
```bash
# –ï—Å–ª–∏ PDB –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏, –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç:
# "Cannot evict pod as it would violate the pod's disruption budget"
```

## üéâ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

**PDB - —ç—Ç–æ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –æ—Ç downtime!**

‚úÖ **–ë–µ–∑ PDB**: –†–∏—Å–∫ –ø–æ–ª–Ω–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏  
‚úÖ **–° PDB**: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–æ–≤  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞** –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ **Zero-downtime deployments** –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ  

**PDB –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è production-ready HA –∫–ª–∞—Å—Ç–µ—Ä–æ–≤!**
